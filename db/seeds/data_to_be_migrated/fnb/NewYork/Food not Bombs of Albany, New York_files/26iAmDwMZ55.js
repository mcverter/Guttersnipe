if (self.CavalryLogger) { CavalryLogger.start_js(["9Vt+c"]); }

__d("ConversationNubAddTabSource",[],(function a(b,c,d,e,f,g){f.exports={NOTIFICATION:"notification",PAGE_REFRESH:"page_refresh",USER_PIN:"user_pin",UNSEEN_NOTIFICATION:"unseen_notification",UNKNOWN:"unknown"};}),null);
__d('ConversationNub',['csx','cx','Arbiter','ConversationNubHeader','ConversationNubTabsUpdateEventController','ConversationNubSize','ConversationNubUtils','NotificationUserActions','PinnedConversationNubsConfig','PinnedConversationNubsSize','CSS','DOM','EventListener','ConversationNubTabState','SubscriptionsHandler','URI','debounce','guid'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('ConversationNubTabsUpdateEventController').minimizeAndInformTabUpdate,k=c('ConversationNubTabsUpdateEventController').popOutAndInformTabUpdate,l=c('ConversationNubTabState'),m=10,n=500,o=100;p.createDefaultState=function(q,r,s,t,u,v,w){return {tabID:q,permalinkURI:r?new (c('URI'))(r):null,ftID:s,notifAlertID:t,notificationType:u,title:v,keepAtBottom:false,isTabRaised:false,isBlinkingUnread:false,badgeCount:0,shouldShowNux:w===true,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:false};};function p(q,r,s){this.$ConversationNub1=q;this.$ConversationNub10=r;this.$ConversationNub5=c('guid')();this.$ConversationNub7=null;this.$ConversationNub8=false;this.$ConversationNub9=null;this.$ConversationNub6=new (c('SubscriptionsHandler'))();this.$ConversationNub11();this.$ConversationNub12();if(s!=null)l.modifyTabState(this.$ConversationNub10,function(t){if(s){t.hasFakeInitBadge=false;}else{t.hasFakeInitBadge=true;this.$ConversationNub13(1);this.$ConversationNub14(true);}}.bind(this));this.$ConversationNub15();}p.prototype.$ConversationNub15=function(){this.$ConversationNub16();this.$ConversationNub17();c('ConversationNubUtils').informShouldRecheckTabVisibility(this);this.forceReflow();};p.prototype.getPersistentState=function(){return l.getTabState(this.$ConversationNub10);};p.prototype.$ConversationNub11=function(){var q=this.$ConversationNub18();if(q){this.$ConversationNub6.addSubscriptions(c('EventListener').listen(q,'click',this.$ConversationNub19.bind(this)),c('EventListener').listen(q,'mouseenter',this.$ConversationNub20.bind(this)),c('EventListener').listen(q,'mouseleave',this.$ConversationNub21.bind(this)));var r=c('ConversationNubUtils').getCloseButtonElem(q);if(r)c('ConversationNubUtils').addCloseButtonListeners(r,this.$ConversationNub6,this.$ConversationNub22.bind(this));}var s=this.$ConversationNub23();if(s){l.modifyTabState(this.$ConversationNub10,function(u){u.keepAtBottom=true;});this.$ConversationNub6.addSubscriptions(c('EventListener').listen(s,'scroll',c('debounce')(this.$ConversationNub24.bind(this),o)),c('Arbiter').subscribe('reflow',this.$ConversationNub25.bind(this)));}var t=this.$ConversationNub26();if(t)this.$ConversationNub6.addSubscriptions(c('EventListener').listen(t,'focusin',this.$ConversationNub27.bind(this)));};p.prototype.$ConversationNub12=function(){var q=this.$ConversationNub28();if(!q){this.$ConversationNub2=null;return;}var r=function(){var t=this.getPersistentState();return {permalinkURI:t.permalinkURI,ftID:t.ftID,tabID:t.tabID};}.bind(this),s=new (c('ConversationNubHeader'))(q,r);this.$ConversationNub6.addSubscriptions(s.subscribe('closeButton',this.$ConversationNub22.bind(this)),s.subscribe('showMenu',this.$ConversationNub29.bind(this)),s.subscribe('hideMenu',this.$ConversationNub30.bind(this)),s.subscribe('minimizeButton',this.$ConversationNub31.bind(this,true)),s.subscribe('clickHeader',this.$ConversationNub31.bind(this,true)),s.subscribe('menuPermalinkClick',this.$ConversationNub31.bind(this,false)));this.$ConversationNub2=s;};p.prototype.$ConversationNub28=function(){return this.$ConversationNub1&&c('DOM').scry(this.$ConversationNub1,".fbNubFlyoutTitlebar")[0];};p.prototype.$ConversationNub18=function(){return this.$ConversationNub1&&c('DOM').scry(this.$ConversationNub1,".fbNubButton")[0];};p.prototype.$ConversationNub23=function(){if(!this.$ConversationNub3&&this.$ConversationNub1)this.$ConversationNub3=c('DOM').scry(this.$ConversationNub1,".uiScrollableAreaWrap")[0];return this.$ConversationNub3;};p.prototype.$ConversationNub26=function(){if(!this.$ConversationNub4&&this.$ConversationNub1)this.$ConversationNub4=c('DOM').scry(this.$ConversationNub1,".fbNubFlyoutBodyContent")[0];return this.$ConversationNub4;};p.prototype.$ConversationNub32=function(){var q=this.$ConversationNub18();if(q)return c('DOM').scry(q,"._37op")[0];return null;};p.prototype.$ConversationNub22=function(){c('ConversationNubUtils').informShouldCloseTab(this.$ConversationNub10,c('ConversationNubUtils').CLOSE_REASON_TAB_X_OUT);};p.prototype.$ConversationNub31=function(q){j(this,q);};p.prototype.$ConversationNub29=function(){this.$ConversationNub1&&c('CSS').addClass(this.$ConversationNub1,"_1uw3");};p.prototype.$ConversationNub30=function(){this.$ConversationNub1&&c('CSS').removeClass(this.$ConversationNub1,"_1uw3");};p.prototype.$ConversationNub19=function(){if(this.getPersistentState().isTabRaised){j(this,true);}else k(this,true);};p.prototype.$ConversationNub20=function(){if(this.getPersistentState().isBlinkingUnread)this.$ConversationNub9=new Date();};p.prototype.$ConversationNub21=function(){var q=this.$ConversationNub9;if(q&&this.getPersistentState().isBlinkingUnread){var r=new Date();if(r-q>=n)this.$ConversationNub14(false);}this.$ConversationNub9=null;};p.prototype.$ConversationNub33=function(){var q=this.$ConversationNub23();if(q){var r=q.scrollHeight;if(r>0&&!this.$ConversationNub34(q)){this.$ConversationNub8=true;q.scrollTop=r;}}};p.prototype.$ConversationNub34=function(q){q=q||this.$ConversationNub23();return !!(q&&q.scrollTop>=q.scrollHeight-q.clientHeight-m);};p.prototype.$ConversationNub24=function(){if(!this.getPersistentState().isTabRaised)return;l.modifyTabState(this.$ConversationNub10,function(q){q.keepAtBottom=this.$ConversationNub34();c('ConversationNubUtils').informShouldRecheckTabVisibility(this);}.bind(this));if(!this.$ConversationNub8)this.clearJewelNotifications();this.$ConversationNub8=false;};p.prototype.$ConversationNub27=function(){this.clearJewelNotifications();};p.prototype.$ConversationNub25=function(){var q=this.getPersistentState();if(!q.isTabRaised)return;if(q.keepAtBottom){this.$ConversationNub33();this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.$ConversationNub7=setTimeout(function(){if(q.keepAtBottom)this.$ConversationNub33();}.bind(this),100);}};p.prototype.$ConversationNub13=function(q){l.modifyTabState(this.$ConversationNub10,function(r){r.badgeCount=q;this.$ConversationNub16();}.bind(this));};p.prototype.$ConversationNub14=function(q){l.modifyTabState(this.$ConversationNub10,function(r){r.isBlinkingUnread=q;this.$ConversationNub17();}.bind(this));};p.prototype.$ConversationNub16=function(){var q=this.$ConversationNub32();if(!q)return;var r=this.getPersistentState().badgeCount,s=r>0;if(s){c('DOM').setContent(q,r);c('CSS').show(q);}else{c('CSS').hide(q);c('DOM').setContent(q,r);}};p.prototype.$ConversationNub17=function(){if(this.$ConversationNub1){var q=this.getPersistentState().isBlinkingUnread;c('CSS').conditionClass(this.$ConversationNub1,"_53tf",q);}};p.prototype.getRootDOM=function(){return this.$ConversationNub1;};p.prototype.getShouldShowNux=function(){return this.getPersistentState().shouldShowNux;};p.prototype.getTabID=function(){return this.$ConversationNub10;};p.prototype.getNotificationAlertID=function(){return this.getPersistentState().notifAlertID;};p.prototype.getNotificationType=function(){return this.getPersistentState().notificationType;};p.prototype.setNotificationType=function(q){l.modifyTabState(this.$ConversationNub10,function(r){r.notificationType=q;});};p.prototype.getFeedbackTargetID=function(){return this.getPersistentState().ftID;};p.prototype.getPermalinkURI=function(){return this.getPersistentState().permalinkURI;};p.prototype.getTitle=function(){return this.getPersistentState().title;};p.prototype.getBadgeCount=function(){return this.getPersistentState().badgeCount;};p.prototype.getIsRaised=function(){return this.getPersistentState().isTabRaised;};p.prototype.getSessionID=function(){return this.$ConversationNub5;};p.prototype.markCommentsAsSeenWithoutBadging=function(q){l.modifyTabState(this.$ConversationNub10,function(r){q.forEach(function(s){r.allSeenNewComments[s]=true;});});};p.prototype.attemptAddNewCommentsToBadge=function(q){l.modifyTabState(this.$ConversationNub10,function(r){q.forEach(function(u){if(r.allSeenNewComments[u])return;r.allSeenNewComments[u]=true;r.unseenCommentsSinceLastCleared[u]=true;});var s=Object.keys(r.unseenCommentsSinceLastCleared).length;if(r.hasFakeInitBadge)s+=1;var t=r.badgeCount;this.$ConversationNub13(s);this.$ConversationNub14(s>0&&s>t);}.bind(this));};p.prototype.clearBadge=function(){l.clearTabNotifications(this.$ConversationNub10);this.$ConversationNub16();this.$ConversationNub17();};p.prototype.clearJewelNotifications=function(){if(c('PinnedConversationNubsConfig').sharedNotificationsReadStateEnabled){var q=this.getNotificationAlertID();if(q)c('NotificationUserActions').markNotificationsAsRead([q]);}};p.prototype.popOutAndInformTabUpdate=function(){this.popOut();c('ConversationNubTabsUpdateEventController').informTabsUpdated();};p.prototype.popOut=function(){l.modifyTabState(this.$ConversationNub10,function(q){if(this.$ConversationNub1){c('CSS').addClass(this.$ConversationNub1,"_5r93");if(c('ConversationNubSize').getTabSize()===c('PinnedConversationNubsSize').SMALL)c('CSS').addClass(this.$ConversationNub1,"_47zn");}q.isTabRaised=true;this.clearBadge();if(q.keepAtBottom)this.$ConversationNub33();}.bind(this));};p.prototype.minimize=function(){l.modifyTabState(this.$ConversationNub10,function(q){if(this.$ConversationNub1){c('CSS').removeClass(this.$ConversationNub1,"_5r93");c('CSS').removeClass(this.$ConversationNub1,"_47zn");}q.isTabRaised=false;this.$ConversationNub2&&this.$ConversationNub2.hideMenu();this.clearBadge();}.bind(this));};p.prototype.forceReflow=function(){this.$ConversationNub25();};p.prototype.destroy=function(){this.minimize();this.$ConversationNub6.release();this.$ConversationNub2&&this.$ConversationNub2.destroy();this.$ConversationNub2=null;this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);if(this.$ConversationNub1){c('DOM').remove(this.$ConversationNub1);c('Arbiter').inform('ConversationNub/destroy',{root:this.$ConversationNub1});this.$ConversationNub1=null;}};f.exports=p;}),null);
__d('ConversationNubHeader',['csx','ArbiterMixin','Bootloader','ConversationNubUtils','DOM','Event','EventListener','Keys','SubscriptionsHandler','ifRequired','mixin'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;function k(m,n){return c('EventListener').listen(m,'keydown',function(o){if(c('Event').getKeyCode(o)===c('Keys').RETURN)n(o);});}i=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function l(m,n){j.constructor.call(this);this.$ConversationNubHeader6=false;this.$ConversationNubHeader1=m;this.$ConversationNubHeader3=n;this.$ConversationNubHeader4=null;this.$ConversationNubHeader5=false;this.$ConversationNubHeader2=new (c('SubscriptionsHandler'))();this.$ConversationNubHeader7();}l.prototype.$ConversationNubHeader7=function(){var m=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(m,'click',this.$ConversationNubHeader8.bind(this)));var n=c('ConversationNubUtils').getCloseButtonElem(m);if(n)c('ConversationNubUtils').addCloseButtonListeners(n,this.$ConversationNubHeader2,this.$ConversationNubHeader9.bind(this));var o=this.$ConversationNubHeader10();if(o)this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(o,'click',this.$ConversationNubHeader11.bind(this)),k(o,this.$ConversationNubHeader11.bind(this)));var p=this.$ConversationNubHeader12();if(p)this.$ConversationNubHeader2.addSubscriptions(c('EventListener').listen(p,'click',this.$ConversationNubHeader13.bind(this)),c('EventListener').listen(p,'mouseover',this.$ConversationNubHeader14.bind(this)),c('EventListener').listen(p,'focus',this.$ConversationNubHeader15.bind(this)),k(p,this.$ConversationNubHeader16.bind(this)));};l.prototype.$ConversationNubHeader12=function(){return c('DOM').scry(this.$ConversationNubHeader1,"._1rf1")[0];};l.prototype.$ConversationNubHeader10=function(){return c('DOM').scry(this.$ConversationNubHeader1,"._4a56")[0];};l.prototype.$ConversationNubHeader17=function(){return c('ConversationNubUtils').getCloseButtonElem(this.$ConversationNubHeader1);};l.prototype.$ConversationNubHeader9=function(){this.inform('closeButton');};l.prototype.$ConversationNubHeader11=function(m){if(m.type==='click')m.kill();this.inform('minimizeButton');};l.prototype.$ConversationNubHeader8=function(){this.inform('clickHeader');};l.prototype.$ConversationNubHeader18=function(){this.inform('showMenu');};l.prototype.$ConversationNubHeader19=function(){this.inform('hideMenu');var m=this.$ConversationNubHeader12();m&&m.blur();};l.prototype.$ConversationNubHeader20=function(){this.inform('menuPermalinkClick');};l.prototype.$ConversationNubHeader21=function(m){if(this.$ConversationNubHeader4)return;var n=this.$ConversationNubHeader12();if(!n)return;if(m)this.$ConversationNubHeader5=true;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(o,p,q){if(this.$ConversationNubHeader6)return;var r=babelHelpers['extends']({},this.$ConversationNubHeader3(),{onMenuShow:this.$ConversationNubHeader18.bind(this),onMenuHide:this.$ConversationNubHeader19.bind(this),onPermalinkClick:this.$ConversationNubHeader20.bind(this),showOnMount:this.$ConversationNubHeader5});this.$ConversationNubHeader4=p.render(o.createElement(q,r),n);}.bind(this),'ConversationNubHeader');};l.prototype.$ConversationNubHeader13=function(m){m.kill();this.$ConversationNubHeader21(true);};l.prototype.$ConversationNubHeader14=function(){this.$ConversationNubHeader21(false);};l.prototype.$ConversationNubHeader15=function(){this.$ConversationNubHeader21(false);};l.prototype.$ConversationNubHeader16=function(){if(this.$ConversationNubHeader4){this.$ConversationNubHeader4.toggle();}else this.$ConversationNubHeader21(true);};l.prototype.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide();};l.prototype.destroy=function(){this.$ConversationNubHeader6=true;var m=this.$ConversationNubHeader12();if(m&&this.$ConversationNubHeader4)c('ifRequired')('ReactDOM',function(n){n.unmountComponentAtNode(m);});this.$ConversationNubHeader2.release();};f.exports=l;}),null);
__d('ConversationNubMarkAsSeenHandlers',['Arbiter','ConversationNubTabsUpdateEventController','ConversationNubUtils','NotificationUserActions','SubscriptionsHandler'],(function a(b,c,d,e,f,g){'use strict';function h(){this.$ConversationNubMarkAsSeenHandlers1=new (c('SubscriptionsHandler'))();this.$ConversationNubMarkAsSeenHandlers1.addSubscriptions(c('Arbiter').subscribe(c('ConversationNubUtils').CLOSE_TAB_EVENT,function(j,k){var l=k.tabState;i(l.notifAlertID);}),c('Arbiter').subscribe(c('ConversationNubTabsUpdateEventController').TAB_MINIMIZED_BY_USER_EVENT,function(j,k){var l=k.tab;return (i(l.getNotificationAlertID()));}));}h.prototype.destroy=function(){this.$ConversationNubMarkAsSeenHandlers1.release();};function i(j){if(j)c('NotificationUserActions').markNotificationsAsSeen([j]);}f.exports=h;}),null);
__d('ConversationNubTabState',['invariant','ConversationNubTabStateList','PinnedConversationNubsConfig'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$ConversationNubTabStateClass1=Object.create(null);this.$ConversationNubTabStateClass2=new (c('ConversationNubTabStateList'))();this.$ConversationNubTabStateClass3=Infinity;this.maxTabsLoaded=Infinity;if(c('PinnedConversationNubsConfig').numberOfTabsLimit&&c('PinnedConversationNubsConfig').numberOfTabsLimit>0)this.maxTabsLoaded=c('PinnedConversationNubsConfig').numberOfTabsLimit;}i.prototype.getTabState=function(j){return this.$ConversationNubTabStateClass2.getTabState(j);};i.prototype.getTabStateIfExists=function(j){return this.$ConversationNubTabStateClass2.getTabStateIfExists(j);};i.prototype.getUnloadedTabs=function(){var j=this.$ConversationNubTabStateClass2.getTabs().filter(function(k){return !this.getLoadedTab(k.tabID);}.bind(this));return j;};i.prototype.setMaxDockTabs=function(j){this.$ConversationNubTabStateClass3=j;};i.prototype.getNumDockTabs=function(){var j=this.$ConversationNubTabStateClass3,k=this.getTotalTabCount();return Math.min(j,k);};i.prototype.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs();};i.prototype.addTabState=function(j){this.$ConversationNubTabStateClass2.push(j);};i.prototype.addLoadedTab=function(j,k){var l=this.getTabState(j);if(!l)return;var m=this.getLoadedTab(j);if(m)return;this.$ConversationNubTabStateClass1[j]=k;this.$ConversationNubTabStateClass4();};i.prototype.getLoadedTab=function(j){return this.$ConversationNubTabStateClass1[j];};i.prototype.getLoadedTabByFeedbackTarget=function(j){return this.getLoadedTabs().find(function(k){return k.getPersistentState().ftID===j;});};i.prototype.isTabInDock=function(j){var k=this.getLoadedTab(j);if(!k)return false;var l=this.$ConversationNubTabStateClass5(k);return 0<=l&&l<this.getNumDockTabs();};i.prototype.clearTabNotifications=function(j){this.$ConversationNubTabStateClass2.modifyTabState(j,function(k){k.unseenCommentsSinceLastCleared={};k.hasFakeInitBadge=false;k.badgeCount=0;k.isBlinkingUnread=false;});};i.prototype.deleteTab=function(j){var k=this.getLoadedTab(j);if(k){delete this.$ConversationNubTabStateClass1[j];k.destroy();}this.$ConversationNubTabStateClass2.remove(j);return Boolean(k);};i.prototype.deleteAllTabs=function(){this.getUnsortedLoadedTabs().forEach(function(j){return this.deleteTab(j.getTabID());}.bind(this));};i.prototype.modifyTabState=function(j,k){return this.$ConversationNubTabStateClass2.modifyTabState(j,k);};i.prototype.moveTabToDockLeft=function(j){var k=this.getLoadedTab(j);if(!k)return;this.$ConversationNubTabStateClass2.modifyTabs(function(l){var m=l.findIndex(function(v){return v.tabID===j;});m!==-1||h(0);var n=l[m],o=this.$ConversationNubTabStateClass5(k),p=this.getLoadedTabs().length,q=this.getNumDockTabs();if(o<0||p===0){return l;}else if(q===0){if(o!==0){l.splice(m,1);l.unshift(n);}return l;}var r=q-1;if(o===r)return l;l.splice(m,1);if(o<r)r-=1;var s=this.getLoadedTabs()[r],t=this.getTabState(s.getTabID());t||h(0);var u=l.findIndex(function(v){return v.tabID===t.tabID;});l.splice(u,0,n);return l;}.bind(this));};i.prototype.getLoadedTabs=function(){var j=this.$ConversationNubTabStateClass2.getTabs().map(function(k){return this.getLoadedTab(k.tabID);}.bind(this)).filter(Boolean);return j;};i.prototype.getUnsortedLoadedTabs=function(){var j=Object.values(this.$ConversationNubTabStateClass1);return j;};i.prototype.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length;};i.prototype.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs());};i.prototype.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse();};i.prototype.getTabsForMenuOldestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs());};i.prototype.getTabsForMenuNewestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse();};i.prototype.$ConversationNubTabStateClass4=function(){if(this.maxTabsLoaded!==Infinity){var j=this.getLoadedTabs().length;if(j>this.maxTabsLoaded){var k=j-this.maxTabsLoaded,l=this.getTabsForMenuOldestFirst().slice(0,k);l.map(function(m){return m.getTabID();}).forEach(function(m){return this.deleteTab(m);}.bind(this));}}};i.prototype.$ConversationNubTabStateClass5=function(j){return this.getLoadedTabs().indexOf(j);};f.exports=new i();}),null);
__d('PersistedStore',['invariant','EventListener','SubscriptionsHandler','UserAgent','WebStorage','areEqual','deepFreezeValue'],(function a(b,c,d,e,f,g,h){'use strict';function i(j){var k=j.initialValue,l=j.storageKeyPrefix,m=j.serializer,n=j.deserializer,o=j.onDataUpdatedOutOfBand,p=j.onDataUpdatedInOtherBrowserTab,q=j.enablePersistence,r=q===undefined?true:q;this.$PersistedStore2=null;this.$PersistedStore3=null;this.$PersistedStore5=0;this.$PersistedStore12=new (c('SubscriptionsHandler'))();if(r)this.$PersistedStore7=c('WebStorage').getLocalStorage();this.$PersistedStore1=k;this.$PersistedStore4=l;this.$PersistedStore6=l+'.PersistedStoreMetadata';this.$PersistedStore8=m;this.$PersistedStore9=n;this.$PersistedStore10=o;this.$PersistedStore11=p;if(r&&p)this.$PersistedStore14();this.reloadFromStorageIfNecessary();}i.prototype.$PersistedStore14=function(){if(c('UserAgent').isBrowser('Chrome')&&typeof BroadcastChannel==='function'){this.$PersistedStore13=new BroadcastChannel(i.BROADCAST_CHANNEL_NAME);this.$PersistedStore13.onmessage=this.$PersistedStore15.bind(this);}else this.$PersistedStore12.addSubscriptions(c('EventListener').listen(window,'storage',this.$PersistedStore16.bind(this)));};i.prototype.$PersistedStore15=function(j){this.$PersistedStore17();};i.prototype.$PersistedStore16=function(j){if(j.key===this.$PersistedStore4)this.$PersistedStore17();};i.prototype.$PersistedStore17=function(){var j=this.$PersistedStore18();if(j&&this.$PersistedStore11)this.$PersistedStore11(j);};i.prototype.$PersistedStore19=function(j){var k=JSON.stringify(this.$PersistedStore8(j));return this.$PersistedStore9(JSON.parse(k));};i.prototype.$PersistedStore20=function(){return this.$PersistedStore19(this.$PersistedStore1);};i.prototype.isPersisted=function(){return this.$PersistedStore7!=null;};i.prototype.modify=function(j){this.$PersistedStore3=null;if(!this.isPersisted()){this.$PersistedStore1=j(this.$PersistedStore1);}else if(this.$PersistedStore2){this.$PersistedStore2=j(this.$PersistedStore2);}else{var k=void 0;try{this.$PersistedStore2=this.$PersistedStore20();k=j(this.$PersistedStore2);}finally{this.$PersistedStore2=null;}if(k&&!c('areEqual')(this.$PersistedStore1,k)){this.$PersistedStore1=k;this.$PersistedStore21();}}};i.prototype.getData=function(){if(!this.isPersisted()){return this.$PersistedStore1;}else if(this.$PersistedStore3)return this.$PersistedStore3;var j=void 0;if(this.$PersistedStore2){j=this.$PersistedStore19(this.$PersistedStore2);c('deepFreezeValue')(j);}else{j=this.$PersistedStore20();c('deepFreezeValue')(j);this.$PersistedStore3=j;}return j;};i.prototype.$PersistedStore22=function(j){if(this.$PersistedStore7!=null)if(j>i.VERSION){this.$PersistedStore7=null;}else if(j<i.VERSION){this.$PersistedStore7.removeItem(this.$PersistedStore6);this.$PersistedStore7.removeItem(this.$PersistedStore4);}else return true;return false;};i.prototype.$PersistedStore23=function(){try{if(this.$PersistedStore7!=null){var k=this.$PersistedStore7.getItem(this.$PersistedStore6);if(k!=null){var l=JSON.parse(k),m=Number.parseInt(l.highWaterMark,10),n=Number.parseInt(l.version,10);if(m&&n)return {highWaterMark:m,version:n};}}}catch(j){this.$PersistedStore7=null;}return null;};i.prototype.reloadFromStorageIfNecessary=function(){if(!this.isPersisted())return;var j=this.$PersistedStore23();if(j){var k=j.highWaterMark,l=j.version;if(this.$PersistedStore22(l)&&this.$PersistedStore5<k)this.$PersistedStore24(k);}};i.prototype.$PersistedStore24=function(j){var k=this.$PersistedStore18();if(k)this.$PersistedStore25(k,j);};i.prototype.$PersistedStore18=function(){var j=null;try{if(this.$PersistedStore7){var l=this.$PersistedStore7.getItem(this.$PersistedStore4);if(l!=null)j=JSON.parse(l);}}catch(k){this.$PersistedStore7=null;}return this.$PersistedStore9(j);};i.prototype.$PersistedStore25=function(j,k){this.$PersistedStore3=null;var l=this.$PersistedStore1;this.$PersistedStore1=j;this.$PersistedStore5=k;this.$PersistedStore10(l,j);};i.prototype.$PersistedStore21=function(){this.reloadFromStorageIfNecessary();if(!this.isPersisted())return;var j=this.$PersistedStore8(this.$PersistedStore1),k=JSON.stringify(j),l={highWaterMark:++this.$PersistedStore5,version:i.VERSION},m=JSON.stringify(l);try{this.$PersistedStore7!=null||h(0);this.$PersistedStore7.setItem(this.$PersistedStore6,m);this.$PersistedStore7.setItem(this.$PersistedStore4,k);if(this.$PersistedStore13)this.$PersistedStore13.postMessage(i.BROADCAST_CHANNEL_NAME);}catch(n){this.$PersistedStore7=null;}};i.prototype.$PersistedStore26=function(){this.$PersistedStore12.release();if(this.$PersistedStore13)this.$PersistedStore13.close();};i.VERSION=24;i.BROADCAST_CHANNEL_NAME='PersistedStoreMessage-StorageUpdated';f.exports=i;}),null);
__d('filterSet',['Set'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=new (c('Set'))();for(var l=i,m=Array.isArray(l),n=0,l=m?l:l[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var o;if(m){if(n>=l.length)break;o=l[n++];}else{n=l.next();if(n.done)break;o=n.value;}var p=o;if(j(p))k.add(p);}return k;}f.exports=h;}),null);
__d('differenceSets',['filterSet'],(function a(b,c,d,e,f,g){'use strict';function h(i){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++)k[l-1]=arguments[l];return c('filterSet')(i,function(m){return !k.some(function(n){return n.has(m);});});}f.exports=h;}),null);
__d('ConversationNubTabStateList',['invariant','ConversationNubUtils','PersistedStore','PinnedConversationNubsConfig','Set','URI','differenceSets'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$ConversationNubTabStateList2=new (c('Set'))();var j=c('PinnedConversationNubsConfig').syncTabCloseEnabled?this.$ConversationNubTabStateList3.bind(this):undefined;this.$ConversationNubTabStateList1=new (c('PersistedStore'))({initialValue:[],storageKeyPrefix:'conversationNubTabState',serializer:i.serializeStateArrayToJson,deserializer:i.deserializeJsonToStateArray,onDataUpdatedOutOfBand:this.$ConversationNubTabStateList4.bind(this),onDataUpdatedInOtherBrowserTab:j,enablePersistence:c('PinnedConversationNubsConfig').persistenceEnabled});}i.prototype.modifyTabState=function(j,k){this.modifyTabs(function(l){var m=l.findIndex(function(n){return n.tabID===j;});m!==-1||h(0);k(l[m]);return l;});};i.prototype.$ConversationNubTabStateList5=function(j){return new (c('Set'))(j.map(function(k){return k.tabID;}));};i.prototype.modifyTabs=function(j){try{this.$ConversationNubTabStateList1.modify(function(k){var l=this.$ConversationNubTabStateList5(k),m=j(k),n=this.$ConversationNubTabStateList5(m);this.$ConversationNubTabStateList2=c('differenceSets')(l,n);return m;}.bind(this));}finally{this.$ConversationNubTabStateList2=new (c('Set'))();}};i.prototype.getTabs=function(){return this.$ConversationNubTabStateList1.getData();};i.prototype.getTabState=function(j){var k=this.getTabStateIfExists(j);k||h(0);return k;};i.prototype.getTabStateIfExists=function(j){return this.getTabs().find(function(k){return k.tabID===j;});};i.prototype.$ConversationNubTabStateList3=function(j){var k=this.$ConversationNubTabStateList5(this.$ConversationNubTabStateList1.getData()),l=this.$ConversationNubTabStateList2,m=this.$ConversationNubTabStateList5(j),n=c('differenceSets')(k,m,l);if(n.size)this.$ConversationNubTabStateList6(n);};i.prototype.$ConversationNubTabStateList6=function(j){for(var k=j,l=Array.isArray(k),m=0,k=l?k:k[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var n;if(l){if(m>=k.length)break;n=k[m++];}else{m=k.next();if(m.done)break;n=m.value;}var o=n;c('ConversationNubUtils').informShouldCloseTab(o,c('ConversationNubUtils').CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB);}};i.prototype.$ConversationNubTabStateList4=function(j,k){var l=j.length!==0,m=this.$ConversationNubTabStateList2.size!==0;if(l||m)this.modifyTabs(function(n){var o=this.$ConversationNubTabStateList5(k),p=this.$ConversationNubTabStateList5(j),q=this.$ConversationNubTabStateList2,r=c('differenceSets')(o,p,q),s=k.filter(function(t){return r.has(t.tabID);});return j.concat(s);}.bind(this));};i.prototype.reloadFromStorageIfNecessary=function(){var j;(j=this.$ConversationNubTabStateList1).reloadFromStorageIfNecessary.apply(j,arguments);};i.serializeStateArrayToJson=function(j){var k=[];if(Array.isArray(j))k=j.map(i.serializeStateToJson).filter(Boolean);return k;};i.serializeStateToJson=function(j){var k=j.permalinkURI?j.permalinkURI.toString():null,l=babelHelpers['extends']({},j,{permalinkURI:k});return l;};i.deserializeJsonToStateArray=function(j){if(Array.isArray(j)){return j.map(i.deserializeJsonToState).filter(Boolean);}else return [];};i.deserializeJsonToState=function(j){if(j!=null&&typeof j.tabID==='string'&&typeof j.ftID==='string'&&typeof j.title==='string'&&typeof j.keepAtBottom==='boolean'&&typeof j.isTabRaised==='boolean'&&typeof j.isBlinkingUnread==='boolean'&&j.allSeenNewComments!=null&&j.allSeenNewComments instanceof Object&&j.unseenCommentsSinceLastCleared!=null&&j.unseenCommentsSinceLastCleared instanceof Object&&typeof j.hasFakeInitBadge==='boolean'&&typeof j.badgeCount==='number'&&typeof j.shouldShowNux==='boolean'&&(j.permalinkURI==null||typeof j.permalinkURI==='string')&&(j.notifAlertID==null||typeof j.notifAlertID==='string')&&(j.notificationType==null||typeof j.notificationType==='string')){var k=j.permalinkURI?new (c('URI'))(j.permalinkURI):null,l={tabID:j.tabID,ftID:j.ftID,notifAlertID:j.notifAlertID,notificationType:j.notificationType,title:j.title,keepAtBottom:j.keepAtBottom,isTabRaised:j.isTabRaised,isBlinkingUnread:j.isBlinkingUnread,allSeenNewComments:j.allSeenNewComments,unseenCommentsSinceLastCleared:j.unseenCommentsSinceLastCleared,hasFakeInitBadge:j.hasFakeInitBadge,badgeCount:j.badgeCount,shouldShowNux:j.shouldShowNux,permalinkURI:k};return l;}else return null;};i.prototype.push=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];this.modifyTabs(function(m){k.forEach(function(n){if(m.find(function(o){return o.tabID===n.tabID;})){h(0);}else m.push(n);});return m;});};i.prototype.remove=function(j){this.modifyTabs(function(k){var l=k.findIndex(function(m){return m.tabID===j;});if(l!==-1)k.splice(l,1);return k;});};f.exports=i;}),null);
__d('ConversationNubTabsUpdateEventController',['Arbiter','ConversationNubUtils'],(function a(b,c,d,e,f,g){'use strict';var h='ConversationNub/tabsUpdated',i='ConversationNub/minimizedByUser',j='ConversationNub/maximizedByUser',k=false;function l(p){if(!k)c('Arbiter').inform(h,p);}function m(p){return c('Arbiter').subscribe(h,function(q,r){k=true;p(r);k=false;});}function n(p,q){q&&c('Arbiter').inform(i,{tab:p});p.minimize();l();}function o(p,q){if(!q&&!c('ConversationNubUtils').allowProgrammaticPopOut())return;q&&c('Arbiter').inform(j,{tab:p});p.popOut();l();}f.exports={TAB_MINIMIZED_BY_USER_EVENT:i,TAB_MAXIMIZED_BY_USER_EVENT:j,informTabsUpdated:l,subscribeToTabsUpdated:m,minimizeAndInformTabUpdate:n,popOutAndInformTabUpdate:o};}),null);
__d("XConversationNubTogglePinController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/nub_story\/toggle_pin\/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:false},with_render:{type:"Bool",defaultValue:false},notif_setting:{type:"Enum",enumType:1},tab_size:{type:"Enum",defaultValue:1,enumType:0}});}),null);
__d("XConversationsToggleController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/conversation\/toggle_feature\/",{turn_conversations_on:{type:"Bool",defaultValue:false}});}),null);
__d('isBusinessURI',['isFacebookURI'],(function a(b,c,d,e,f,g){'use strict';function h(i){return c('isFacebookURI')(i)&&i.getSubdomain()==='business';}f.exports=h;}),null);
__d('ConversationNubUtils',['csx','Arbiter','AsyncFeature','AsyncRequest','ConversationNubSize','DOM','Event','EventListener','Keys','NotificationConversationController','URI','XConversationNubTogglePinController','XConversationsToggleController','ConversationNubTabState','isBusinessURI','isCanvasAppURI'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('ConversationNubTabState'),j={DISABLE:'disable',ENABLE:'enable'},k='ConversationNubUtils/closeTab',l='ConversationNubUtils/unpinnedFromHeader',m='ConversationNubUtils/recheckTabVisibility',n='ConversationNubUtils/openPermalinkFromHeader',o='ConversationNubUtils/turnOff',p='ConversationNubUtils/turnOn',q='tab-x-out',r='browser-tab-sync',s='overflow-x-out',t='unpin';function u(oa){var pa=Object.values(j);return pa.find(function(qa){return qa===oa;})||null;}function v(oa,pa,qa,ra){var sa=ra||{},ta=sa.notif_setting,ua=c('XConversationNubTogglePinController').getURIBuilder().setString('ft_id',String(oa)).setBool('pin',pa).setEnum('tab_size',c('ConversationNubSize').getTabSize());if(ta&&c('AsyncFeature').__serverHasFeatureImpl(3))ua.setEnum('notif_setting',ta);var va=ua.getURI(),wa=new (c('AsyncRequest'))().setURI(va).setMethod('POST');if(qa)wa.setAllowCrossPageTransition(true);wa.send();}function w(oa){var pa=c('XConversationsToggleController').getURIBuilder().setBool('turn_conversations_on',oa).getURI();oa?na():ma();var qa=new (c('AsyncRequest'))().setURI(pa).setAllowCrossPageTransition(true).setHandler(function(ra){if(ra.getPayload().conversationsStatus){na();}else ma();}).setErrorHandler(function(ra){oa?ma():na();}).setMethod('POST');qa.send();}function x(oa,pa,qa){v(oa,true,pa,qa);}function y(oa,pa,qa){v(oa,false,pa,qa);}function z(oa,pa){x(oa,false,pa);}function aa(oa,pa){y(oa,false,pa);}function ba(oa,pa){x(oa,true,pa);}function ca(oa,pa){y(oa,true,pa);}function da(){w(false);c('NotificationConversationController').deleteAllTabs();}function ea(){w(true);}function fa(oa){return c('DOM').scry(oa,"._4iz6")[0];}function ga(oa,pa,qa){var ra=function sa(){qa();};pa.addSubscriptions(c('EventListener').listen(oa,'click',ra),c('EventListener').listen(oa,'keydown',function(sa){if(c('Event').getKeyCode(sa)===c('Keys').RETURN)ra();}));}function ha(){var oa=c('URI').getRequestURI();return !c('isCanvasAppURI')(oa)&&!c('isBusinessURI')(oa);}function ia(oa,pa){var qa=i.getLoadedTab(oa);if(!qa)return;var ra=qa.getPersistentState(),sa=qa.getSessionID();c('Arbiter').inform(k,{tabID:oa,tabState:ra,sessionID:sa,reason:pa});}function ja(oa){var pa=i.getLoadedTab(oa);if(!pa)return;c('Arbiter').inform(l,{tab:pa});}function ka(oa){c('Arbiter').inform(m,{tab:oa});}function la(oa){var pa=i.getLoadedTab(oa);if(!pa)return;c('Arbiter').inform(n,{tab:pa});}function ma(){c('Arbiter').inform(o,{});}function na(){c('Arbiter').inform(p,{});}f.exports={CLOSE_TAB_EVENT:k,UNPIN_FROM_HEADER_EVENT:l,OPEN_PERMALINK_FROM_HEADER_EVENT:n,TURN_CONVERSATIONS_OFF_EVENT:o,TURN_CONVERSATIONS_ON_EVENT:p,CLOSE_REASON_TAB_X_OUT:q,CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB:r,CLOSE_REASON_OVERFLOW_X_OUT:s,CLOSE_REASON_UNPIN:t,coerceToPinRequestNotifSetting:u,sendPinRequest:z,sendUnpinRequest:aa,sendPinRequestAcrossTransitions:ba,sendUnpinRequestAcrossTransitions:ca,getCloseButtonElem:fa,addCloseButtonListeners:ga,informShouldCloseTab:ia,informDidUnpinFromHeaderMenu:ja,informShouldRecheckTabVisibility:ka,informOpenPermalinkFromHeader:la,allowProgrammaticPopOut:ha,turnConversationsOff:da,turnConversationsOn:ea};}),null);
__d('ConversationNubPermalinkUtils',['URI','isFacebookURI'],(function a(b,c,d,e,f,g){'use strict';function h(l){return l.substr(-1)==='/'?l.slice(0,-1):l;}function i(l,m){var n=l.getPath(),o=m.getPath();return h(n)===h(o);}function j(l,m,n){var o=l.getQueryData(),p=m.getQueryData(),q=o[n],r=p[n];if(q==null&&r==null)return true;return q===r;}function k(l){var m=new (c('URI'))(window.location.href);return (m&&l&&c('isFacebookURI')(m)&&c('isFacebookURI')(l)&&i(m,l)&&j(m,l,'fbid')&&j(m,l,'story_fbid'));}f.exports={isOnPermalink:k};}),null);
__d('ConversationNubViewportManager',['DockTabsViewportCalculator','DockTabsViewportPinnedConversationTabUtils'],(function a(b,c,d,e,f,g){'use strict';var h=c('DockTabsViewportPinnedConversationTabUtils').getMinRequiredWidthForFirstConvoTab;function i(j,k,l){this.$ConversationNubViewportManager1=j;this.$ConversationNubViewportManager3=k;this.$ConversationNubViewportManager2=c('DockTabsViewportCalculator').getInstance(this.$ConversationNubViewportManager1);this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.registerPinnedConvoTabCallbacks(babelHelpers['extends']({},l,{pinnedConvoTabStateGetter:function(){return this.$ConversationNubViewportManager3;}.bind(this)}));}i.prototype.getNumDockTabsToShow=function(j){return this.getCouldFitAtLeastOneDockTab(j)?1:0;};i.prototype.getCouldFitAtLeastOneDockTab=function(j){var k=h();return k<=j;};i.prototype.forceRecalculatePinnedConvoTabs=function(j){this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.forceRecalculatePinnedConvoTabs(j);};f.exports=i;}),null);
__d('ConversationNubVisibilityDedupeUtils',['Bootloader','emptyFunction','ifRequired'],(function a(b,c,d,e,f,g){'use strict';function h(j){c('Bootloader').loadModules(["UFICommentVisibilityStore"],j,'ConversationNubVisibilityDedupeUtils');}function i(j){return c('ifRequired')('UFICommentVisibilityStore',function(k){return (k.isFeedbackTargetVisible(j));},c('emptyFunction').thatReturnsFalse);}f.exports={bootloadUFIVisibilityModule:h,isFeedbackTargetVisible:i};}),null);
__d("XNotificationNubStoryController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/conversation\/nub_story\/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:false},tab_size:{type:"Enum",defaultValue:1,enumType:0}});}),null);
__d('NotificationConversationController',['csx','cx','Arbiter','AsyncRequest','Bootloader','CSS','ConversationNub','ConversationNubAddTabSource','ConversationNubMarkAsSeenHandlers','ConversationNubPermalinkUtils','ConversationNubSize','ConversationNubTabState','ConversationNubTabsUpdateEventController','ConversationNubUtils','ConversationNubViewportManager','ConversationNubVisibilityDedupeUtils','DOM','NotificationConstants','NotificationStore','NotificationUpdates','PinnedConversationNubsConfig','SubscriptionsHandler','URI','XNotificationNubStoryController','ge','ifRequired'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('NotificationConstants').PayloadSourceType,k=j.LIVE_SEND,l=j.OTHER_APPLICATION,m=j.ENDPOINT,n=c('ConversationNubVisibilityDedupeUtils').bootloadUFIVisibilityModule,o=c('ConversationNubVisibilityDedupeUtils').isFeedbackTargetVisible,p=1,q=c('ConversationNubTabState'),r=Object.create(null),s=null,t=null,u=null,v=null,w=null,x=null,y=false,z=null,aa=null,ba=null,ca=null,da=Object.create(null);function ea(){if(!t)t=c('DOM').scry(c('ge')('pagelet_dock'),"._1mw-")[0];return t;}function fa(){if(!u){var ia=ea();if(ia)u=c('DOM').scry(ia,"._1tvj")[0];}return u;}function ga(){if(!v){var ia=ea();if(ia)v=c('DOM').scry(ia,"._2ikx .fbNubButton")[0];}return v;}function ha(){this.$NotificationConversationController1=null;this.$NotificationConversationController8=function(ia){var ja=Object.values(ia);this.$NotificationConversationController5(ja);}.bind(this);}ha.prototype.init=function(){if(y)return;y=true;this.$NotificationConversationController2();var ia='update-notifications';if(c('PinnedConversationNubsConfig').notificationsWhileAwayEnabled)this.$NotificationConversationController1=new (c('ConversationNubMarkAsSeenHandlers'))();var ja=new (c('SubscriptionsHandler'))();ja.addSubscriptions(c('NotificationUpdates').subscribe(ia,function(ka,la){if(c('PinnedConversationNubsConfig').sharedNotificationsReadStateEnabled&&la.payloadsource===k&&la.readState&&Object.keys(la.readState).length){this.$NotificationConversationController3(la.readState);}else if(la.payloadsource===k||la.payloadsource===l){var ma=la.nodes;if(ma&&ma.length)this.$NotificationConversationController4(ma,c('ConversationNubAddTabSource').NOTIFICATION);}else if(c('PinnedConversationNubsConfig').notificationsWhileAwayEnabled&&la.payloadsource===m){var na=la.nodes;if(na&&na.length)this.$NotificationConversationController5(na);}}.bind(this)),c('ConversationNubTabsUpdateEventController').subscribeToTabsUpdated(this.$NotificationConversationController6.bind(this)),c('Arbiter').subscribe(c('ConversationNubUtils').CLOSE_TAB_EVENT,function(ka,la){var ma=la||{},na=ma.tabID;if(na)this.$NotificationConversationController7(na);}.bind(this)));if(c('PinnedConversationNubsConfig').notificationsWhileAwayEnabled)c('NotificationStore').getNotifications(100,this.$NotificationConversationController8,undefined,'unread');z=ja;if(c('PinnedConversationNubsConfig').markAsReadWhenViewedInFeed)n(function(ka){ja.addSubscriptions(ka.addListener(this.$NotificationConversationController9.bind(this)));}.bind(this));};ha.prototype.$NotificationConversationController5=function(ia){var ja=ia.filter(function(ka){return ka.seen_state==='UNSEEN_AND_UNREAD';});this.$NotificationConversationController4(ja,c('ConversationNubAddTabSource').UNSEEN_NOTIFICATION);};ha.prototype.$NotificationConversationController2=function(){if(c('PinnedConversationNubsConfig').isEnabled)q.getUnloadedTabs().slice(-1*q.maxTabsLoaded).forEach(function(ia){this.$NotificationConversationController10(ia.tabID,ia.ftID,ia.permalinkURI,'page_refresh');}.bind(this));};ha.prototype.$NotificationConversationController11=function(ia){var ja=s?s.getNumDockTabsToShow(ia):p;q.setMaxDockTabs(ja);};ha.prototype.$NotificationConversationController12=function(ia,ja){this.$NotificationConversationController11(ia);if(ja){var ka=ja.tabToPromote,la=ja.tabToOpenIfInDock;if(ka&&!q.isTabInDock(ka.getTabID()))q.moveTabToDockLeft(ka.getTabID());if(c('ConversationNubUtils').allowProgrammaticPopOut()&&la&&q.isTabInDock(la.getTabID()))la.popOut();}this.$NotificationConversationController13(ia);};ha.prototype.$NotificationConversationController6=function(ia){s&&s.forceRecalculatePinnedConvoTabs(ia);};ha.prototype.$NotificationConversationController13=function(ia){var ja=q.getTotalTabCount(),ka=q.getNumDockTabs(),la=s&&s.getCouldFitAtLeastOneDockTab(ia),ma=ja>0&&la,na=ka<ja&&ma,oa=ea();if(oa){c('CSS').conditionClass(oa,"_1tvf",ma);c('CSS').conditionClass(oa,"_1dex",na);c('CSS').conditionClass(oa,"_1tvi",na);}var pa=c('PinnedConversationNubsConfig').pinnedToLeft?q.getTabsForDockOldestFirst():q.getTabsForDockNewestFirst();pa.forEach(function(ra){if(ra.getIsRaised())ra.clearBadge();});var qa=q.getTabsForMenuNewestFirst();this.$NotificationConversationController14(pa);this.$NotificationConversationController15(qa);};ha.prototype.$NotificationConversationController3=function(ia){q.getUnsortedLoadedTabs().forEach(function(ka){var la=ka.getNotificationAlertID();if(ia[la])ka.clearBadge();});q.getUnloadedTabs().forEach(function(ka){if(ia[ka.notifAlertID])q.clearTabNotifications(ka.tabID);});var ja=q.getTabsForMenuNewestFirst();this.$NotificationConversationController15(ja);};ha.prototype.$NotificationConversationController4=function(ia,ja){ia.forEach(function(ka){var la=ka.alert_id,ma=ka.pinnedConvoConfig,na=ka.tracking,oa=ka.notif_type;if(!ma)return;var pa=ma.tab_id,qa=ma.ft_id,ra=ma.permalink_uri,sa=JSON.parse(na),ta=ra?new (c('URI'))(ra):null;this.$NotificationConversationController16(pa,sa.alert_id,qa,la,ta,ja,oa);}.bind(this));};ha.prototype.$NotificationConversationController16=function(ia,ja,ka,la,ma,na,oa){var pa=c('XNotificationNubStoryController').getURIBuilder().setString('notif_alert_id',la).setInt('notif_id',ja);this.$NotificationConversationController17(ka,na);this.$NotificationConversationController18(ia,ka,oa,ma,pa);};ha.prototype.$NotificationConversationController17=function(ia,ja){if(!da[ia])da[ia]=ja;};ha.prototype.$NotificationConversationController10=function(ia,ja,ka,la){this.$NotificationConversationController17(ja,la);var ma=c('XNotificationNubStoryController').getURIBuilder().setString('ft_id',ja);this.$NotificationConversationController18(ia,ja,null,ka,ma);};ha.prototype.$NotificationConversationController18=function(ia,ja,ka,la,ma){if(r[ia])return;var na=q.getLoadedTab(ia);if(na){if(ka)na.setNotificationType(ka);return;}if(c('ConversationNubPermalinkUtils').isOnPermalink(la)||o(ja))ma.setBool('force_minimized',true);ma.setEnum('tab_size',c('ConversationNubSize').getTabSize());r[ia]=true;new (c('AsyncRequest'))().setURI(ma.getURI()).setAllowCrossPageTransition(true).setFinallyHandler(function(){delete r[ia];}).send();};ha.prototype.$NotificationConversationController9=function(){var ia=false;q.getUnsortedLoadedTabs().forEach(function(ja){if(ja.getBadgeCount()>0&&o(ja.getFeedbackTargetID())){ja.clearBadge();ia=true;}});if(ia)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ha.prototype.$NotificationConversationController19=function(ia){var ja=true;q.getUnsortedLoadedTabs().forEach(function(ka){var la=ka.getFeedbackTargetID(),ma=ia[la],na=ma?Object.keys(ma):[];if(na.length){var oa=ka.getBadgeCount();if(o(la)){ka.markCommentsAsSeenWithoutBadging(na);ka.clearBadge();}else ka.attemptAddNewCommentsToBadge(na);var pa=ka.getBadgeCount();if(oa!==pa)ja=true;}});if(ja)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ha.prototype.$NotificationConversationController20=function(ia){if(ca)return;c('Bootloader').loadModules(["ConversationNubSurveys"],function(ja){if(!ca)ca=new ja(ia);},'NotificationConversationController');};ha.prototype.$NotificationConversationController21=function(ia,ja,ka){if(ba){ba.addTab(ia,ka);delete da[ia.getPersistentState().ftID];return;}c('Bootloader').loadModules(["ConversationNubLogger"],function(la){if(!ba)ba=new la(ja);ba.addTab(ia,ka);delete da[ia.getPersistentState().ftID];},'NotificationConversationController');};ha.prototype.$NotificationConversationController22=function(){if(aa)return;c('Bootloader').loadModules(["ConversationNubUFICentralUpdateManager"],function(ia){if(aa)return;aa=new ia(this.$NotificationConversationController19.bind(this));}.bind(this),'NotificationConversationController');};ha.prototype.$NotificationConversationController14=function(ia){var ja=fa();if(!ja)return;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(ka,la,ma){x=la.render(ka.createElement(ma,{dockTabs:ia}),ja);},'NotificationConversationController');};ha.prototype.$NotificationConversationController23=function(ia){ia.popOut();c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:ia});};ha.prototype.$NotificationConversationController15=function(ia){var ja=ga();if(!ja)return;c('Bootloader').loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(ka,la,ma){w=la.render(ka.createElement(ma,{menuTabs:ia,onTabSelected:this.$NotificationConversationController23}),ja);}.bind(this),'NotificationConversationController');};ha.prototype.$NotificationConversationController24=function(){if(!s){var ia=ea();if(ia){var ja={onAvailableWidthChanged:this.$NotificationConversationController12.bind(this)};s=new (c('ConversationNubViewportManager'))(ia,q,ja);}}};ha.prototype.storyFromServer=function(ia,ja){if(!y)return;var ka=ja.attempt_open_on_init,la=ja.ft_id,ma=ja.init_without_badge,na=ja.notif_alert_id,oa=ja.notification_type,pa=ja.permalink_uri,qa=ja.promote_on_init,ra=ja.tab_add_source,sa=ja.tab_id,ta=ja.title,ua=q.getLoadedTab(sa);if(ua){if(qa||ka)c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:qa?ua:null,tabToOpenIfInDock:ka?ua:null});return;}ma=ma||o(la);var va=q.getTabStateIfExists(sa);if(va){ma=null;}else{var wa=c('ConversationNub').createDefaultState(sa,pa,la,na,oa,ta);q.addTabState(wa);}var xa=new (c('ConversationNub'))(ia,sa,ma);q.addLoadedTab(sa,xa);ka=ka||xa.getPersistentState().isTabRaised;this.$NotificationConversationController22();this.$NotificationConversationController24();c('ConversationNubTabsUpdateEventController').informTabsUpdated({tabToPromote:qa?xa:null,tabToOpenIfInDock:ka?xa:null});this.$NotificationConversationController20(q);var ya=da[la]||ra||'unknown';this.$NotificationConversationController21(xa,q,ya);};ha.prototype.deleteAllTabs=function(){q.deleteAllTabs();c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ha.prototype.$NotificationConversationController7=function(ia){var ja=q.deleteTab(ia);if(ja)c('ConversationNubTabsUpdateEventController').informTabsUpdated();};ha.prototype.unsubscribe=function(){z&&z.release();z=null;ba&&ba.destroy();ba=null;ca&&ca.destroy();ca=null;aa&&aa.destroy();aa=null;if(this.$NotificationConversationController1)this.$NotificationConversationController1.destroy();c('ifRequired')('ReactDOM',function(ia){var ja=ga();if(w&&ja)ia.unmountComponentAtNode(ja);var ka=fa();if(x&&ka)ia.unmountComponentAtNode(ka);});};f.exports=new ha();}),null);