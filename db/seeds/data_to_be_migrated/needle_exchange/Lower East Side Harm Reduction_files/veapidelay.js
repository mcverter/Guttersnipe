window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initMapDelayCode=function(){function fr(e,o,s){function lt(){d&&(n.removeHandler(d),n.removeHandler(st),n.removeHandler(ct),d=null,v.remove_event("mousedown",g).remove_event("dblclick",i).remove_event("touchstart",g).remove_event("keydown",bt).remove_event("keyup",kt),t(y).remove_event("click",dt),t(p).remove_event("click",gt),a.parentNode.removeChild(a),a=null,y=null,l=null,p=null)}function vt(n){var n=e.isRotationEnabled();n!==k&&(k=n,et.set_style(k?{visibility:"visible"}:{visibility:"hidden"}),n||(l.className="NavBar_compass NavBar_compassFlat",rt=null),yt())}function yt(){var t,n;if(k&&(t=e.getTargetHeading(),t!==rt)){n="";switch(ht.snapToCardinalHeading(t)){case ht.northUpHeading:n="NavBar_compassN";break;case ht.eastUpHeading:n="NavBar_compassE";break;case ht.southUpHeading:n="NavBar_compassS";break;case ht.westUpHeading:n="NavBar_compassW"}l.className="NavBar_compass "+n,rt=t}}function pt(n){var i=t.Screen.get_mouse_pos(n),r;isNaN(i.x)&&(i=new f(n.touches[0].pageX,n.touches[0].pageY)),c=new f(i.x-it.x-w.x,i.y-it.y-w.y),r=Math.sqrt(c.x*c.x+c.y*c.y),r<b&&(c.x=c.x/b*ft,c.y=c.y/b*ft)}function wt(){if(Math.abs(c.x)<=1&&(c.x=0),Math.abs(c.y)<=1&&(c.y=0),c.x||c.y){var n=e.tryPixelToLocation(c);n&&e.setView({center:n,animate:!1})}}function g(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),h(e,n),t(document).add_event("mousemove",nt,!0).add_event("mouseup",tt,!0).add_event("touchmove",nt,!0).add_event("touchend",tt,!0).add_event("contextmenu",i,!0),v.add_event("selectstart",i,!0),w=new f(l.offsetWidth/2,l.offsetHeight/2),b=Math.min(w.x,w.y),it=v.get_absolute_pos(),pt(n),wt(),ut=window.setInterval(wt,100))}function bt(t){t.stopPropagation();var i=new ui("keydown",t.keyCode,t.altKey,t.ctrlKey,t.shiftKey,t.charCode);i.originalEvent=t,n.invoke(e,"keydown",i)}function kt(t){t.stopPropagation();var i=new ui("keyup",t.keyCode,t.altKey,t.ctrlKey,t.shiftKey);i.originalEvent=t,n.invoke(e,"keyup",i)}function nt(n){n.preventMouseEvent&&n.preventMouseEvent(),i(n),pt(n)}function tt(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),t(document).remove_event("mousemove",nt,!0).remove_event("mouseup",tt,!0).remove_event("touchmove",nt,!0).remove_event("touchend",tt,!0).remove_event("contextmenu",i,!0),v.remove_event("selectstart",i,!0),window.clearInterval(ut))}function dt(n){i(n),h(e,n),ni(90)}function gt(n){i(n),h(e,n),ni(-90)}function ni(n){e.setView({heading:e.getTargetHeading()+n})}var ti=this,a,l,v,it,w,b,ut,c,ft=15,k,rt,y,p,et,st,ct,d;a=r("div",s.getClassName()),ot(a),y=at("NavBar_rotateLeft",u.getString("L_rotateLeftTooltip_Text")),t(y).add_event("click",dt).set_attr("uici","NB.CS.RotateLeft"),l=r("a"),l.href="#",l.onclick=function(){return!1},l.appendChild(document.createTextNode(u.getString("L_compassNorthLabel_Text"))),v=t(l),l.title=u.getString("L_compassTooltip_Text"),p=at("NavBar_rotateRight",u.getString("L_rotateRightTooltip_Text")),t(p).add_event("click",gt).set_attr("uici","NB.CS.RotateRight"),et=t([y,p]),v.add_event("mousedown",g).add_event("dblclick",i).add_event("touchstart",g).add_event("keydown",bt).add_event("keyup",kt).set_attr("uici","NB.CS.PanControl"),s.getRotateVisible()&&a.appendChild(y),s.getCompassVisible()&&a.appendChild(l),s.getRotateVisible()&&a.appendChild(p),o.appendChild(a),s.getDomElement=function(){return a},st=n.addHandler(e,"imagerychanged",vt),ct=n.addHandler(e,"targetviewchanged",yt),vt(),d=n.addHandler(e,"ondispose",lt),this.dispose=lt}function hi(i,u,f){function et(n){var t=n.keyCode;t in ft&&(l+=ft[t]||0,l===w.length?l=0:l<0&&(l=w.length-1),v===this&&(l=0,nt(),n.stopPropagation()),w[l].receiveFocus(),n.preventDefault())}function nt(){if(tt(),rt=new Date,c||(o(e,"show"),c=!0,it.appendChild(y),t(it).add_class("activeMenu"),t(document).add_event("keydown",e.hideMenu,!0)),h.style.visibility==="hidden"){var f=s.offsetHeight,n=t(s).get_relative_pos().x,l=t(s).get_absolute_pos(),r=i.getRootElement(),u=t(r).get_absolute_pos().x+r.offsetWidth-(l.x+h.offsetWidth);u<0&&(n+=u),h.style.top=f+"px",h.style.left=n+"px",h.style.visibility="visible"}}function b(n){if(tt(),c&&(o(e,"hide"),c=!1,y.parentNode.removeChild(y),t(it).remove_class("activeMenu"),h.style.visibility="hidden",n)){try{v.focus()}catch(i){}t(document).remove_event("keydown",e.hideMenu,!0)}}function tt(){k&&(window.clearTimeout(k),k=null),d&&(window.clearTimeout(d),d=null)}var e=this,it=u,p,c=!1,w=[],rt=new Date(0),ot=300,k,d,l=0,ft={38:-1,104:-1,40:1,98:1},s=r("span","NavBar_button NavBar_typeButton"+(f?" "+f:"")),ut=t(s),a,g,st,v,ht,y,h;ut.add_event("mouseenter",function(n){o(e,"mouseenter",n)}).add_event("mouseleave",function(n){o(e,"mouseleave",n)}).add_event("touchstart",function(n){o(e,"touchstart",n)}),a=r("a","NavBar_typeButtonLabel",s),a.href="#",a.appendChild(document.createTextNode("")),g=t(a),g.add_event("click",function(n){o(e,"clicklabel",n)}).add_event("mouseenter",function(n){o(e,"mouseenterlabel",n)}).add_event("mouseleave",function(n){o(e,"mouseleavelabel",n)}),st=r("span","separator",s),v=r("a","NavBar_dropIconContainer",s),v.href="#",t(v).add_event("click",function(n){o(e,"clickicon",n)}).add_event("keydown",et).add_event("mouseenter",function(n){o(e,"mouseentericon",n)}).add_event("mouseleave",function(n){o(e,"mouseleaveicon",n)}),ht=r("span","NavBar_dropIcon",v),u.appendChild(s),y=r("div","NavBar_ModeSelectorControl"),t(y).add_event("keydown",et),h=r("ul","MicrosoftMap_NavBar_typeMenu",y),h.style.cssText="position:absolute;visibility:hidden",t(h).add_event("mouseenter",function(n){o(e,"mouseenter",n)}).add_event("mouseleave",function(n){o(e,"mouseleave",n)}),this.dispose=function(){s&&(b(),s.parentNode.removeChild(s),s=null)},this.isShown=function(){return c},this.addMenuItem=function(t,i){t&&(w.push(t),n.addHandler(t,"click",function(t){n.invoke(e,"clickitem",t)})),h.appendChild(i)},this.getItems=function(){return w},this.setMapType=function(n){p&&g.remove_class("NavBar_MapType_"+p),p=n,n&&g.add_class("NavBar_MapType_"+p)},this.getMapType=function(){return p},this.updateLabel=function(n){a.replaceChild(document.createTextNode(n),a.firstChild)},this.setSelected=function(n){n?ut.add_class("NavBar_buttonSel"):ut.remove_class("NavBar_buttonSel")},this.toggleMenu=function(){c?new Date-rt>ot&&b():(nt(),rt=new Date(0))},this.showMenu=function(){nt()},this.showMenuDelay=function(n){tt(),c||(k=window.setTimeout(nt,n))},this.hideMenu=function(n){n&&/keydown$/.test(n.type)?n.keyCode===27&&b(!0):b()},this.hideMenuDelay=function(n){tt(),d=window.setTimeout(b,n)}}function ci(u,f,e){var a=this,c=ut[u],s=r("li","NavBar_menuitem"+(f?" NavBar_menuItemSel":"")),o=r("a","NavBar_itemContainer NavBar_itemContainer_"+u,s),l;o.style.cssText="display:block;",o.href="#",t(o).add_event("click",function(t){i(t),n.invoke(a,"click",t),e(u)});var y=r("div","NavBar_typePreview NavBar_typePreview_"+u,o),h=r("div","NavBar_typeContent",o),v=r("div","NavBar_typeTitle",h);v.appendChild(document.createTextNode(c.title)),l=r("div","NavBar_typeDesc",h),l.appendChild(document.createTextNode(c.description)),this.getTypeId=function(){return u},this.getElement=function(){return s},this.receiveFocus=function(){try{o.focus()}catch(n){}},this.getContent=function(){return h},this.setSelected=function(n){s.className="NavBar_menuitem"+(n?" NavBar_menuItemSel":"")}}function er(f,e,s,c){function rt(){var e=f.getOptions(),n,t,i,r,u;if(l=f.getMapTypeId(),l===d?(v=!1,b.disableBirdseye!==!0&&(l=a)):l===a&&(b.disableBirdseye===!0?l=d:v=!0),ut.hasOwnProperty(l)){for(n=w.getItems(),t=n.length;t--;)i=n[t],r=i.getTypeId(),i.setSelected(r==l||it(l)&&it(r));u=ut[l],w.updateLabel(u.title),w.setMapType(f.getMapTypeId())}p=e.labelOverlay!==tt.hidden,g&&(g.checked=p),nt&&(nt.checked=v)}function ft(n){n===a&&(n=b.disableBirdseye!==!0&&v?a:d),f.setView({mapTypeId:n,labelOverlay:p||n===ot?tt.visible:tt.hidden});var t=f.getComponent("analyticsProxy");t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function it(n){return n===d||n===a}function st(n){p=!p,ct(n,g,p)}function ht(n){v=!v,ct(n,nt,v)}function ct(n,t,i){n.stopPropagation(),h(f,n),n.currentTarget.tagName==="SPAN"&&t&&(t.checked=i),it(l)&&ft(a),vt&&w.hideMenuDelay(1e3)}function yt(t){var i=new hi(f,e),v,u,s,c,r;for(i.mapTypes=t,i.updateLabel(ut[t[0]].title),i.setMapType(t[0]),v=[],i.events=v,r=0;r<t.length;r++)u=t[r],u&&(s=new ci(u,l===u,ft),i.addMenuItem(s,s.getElement()),(u===a||u===d&&b.disableBirdseye===!0)&&pt(s.getContent()));for(c=[["clicklabel",function(n){h(f,n),i.toggleMenu()}],["clickicon",function(n){h(f,n),i.toggleMenu()}],["clickitem",function(n){h(f,n),i.hideMenu()}],["mouseenter",function(){i.showMenu()}],["mouseleave",function(){i.hideMenuDelay(1e3)}],["show",function(){o(et,"showmaptypemenu",{menuPosition:0})}],["hide",function(){o(et,"hidemaptypemenu",{menuPosition:0})}]],r=c.length;r--;)v.push(n.addHandler(i,c[r][0],c[r][1]));return i}function pt(n){var s=r("div","NavBar_checkControls"),o=r("div","NavBar_checkControl",s),f=r("input"),e;f.id="LabelCB_"+kt.getNext(),f.setAttribute("type","checkbox"),t(f).add_event("click",st),g=f,o.appendChild(f),f.checked=!0,e=r("span","",o),e.appendChild(document.createTextNode(u.getString("L_aerialShowLabels_Text"))),t(e).add_event("click",function(n){i(n),st(n)}),b.disableBirdseye!==!0&&(o=r("div","NavBar_checkControl",s),f=r("input"),f.id="TiltCB_"+kt.getNext(),f.setAttribute("type","checkbox"),t(f).add_event("click",ht),nt=f,o.appendChild(f),f.checked=!0,e=r("span","",o),e.appendChild(document.createTextNode(u.getString("L_aerialEnableTilt_Text"))),t(e).add_event("click",function(n){i(n),ht(n)})),n.appendChild(s)}var et=this,ot=k.auto,a=k.birdseye,d=k.aerial,l=f.getMapTypeId(),b=c,p=!0,v=y.defaultAerialTiltOn===!0,g=null,nt=null,w=yt([k.road,y.allowCollinsBart?k.collinsBart:null,y.allowOrdnanceSurvey?k.ordnanceSurvey:null,b.disableBirdseye!==!0||y.allowAerialMap?ot:null,b.disableBirdseye!==!0?a:y.allowAerialMap?d:null]),lt=n.addHandler(f,"maptypechanged",rt),at=n.addHandler(f,"optionschanged",rt);rt(),this.dispose=function(){for(var t=w.events,i=t.length;i--;)n.removeHandler(t[i]);w.dispose(),n.removeHandler(lt),n.removeHandler(at)},this.showMenu=function(){w.showMenu()},this.hideMenu=function(){w.hideMenu()},this.getAerialViewSettings=function(){return{showLabels:p,enableTilt:v}},this.setAerialViewSettings=function(n,t){p=n,v=t,it(l)&&ft(a)}}function or(i,f,e,s){function g(){var h=i.getOptions(),r,u,n,s;if(l=i.getMapTypeId(),ut.hasOwnProperty(l))for(r=c.length;r--;){for(var t=c[r],f=!1,e=t.getItems(),o=e.length;o--;)u=e[o],n=u.getTypeId(),u.setSelected(n==l),n==l&&(f=!0,s=ut[n],t.updateLabel(s.title),t.setMapType(n));t.setSelected(f)}!d&&nt(l)&&v&&(a=h.labelOverlay!==tt.hidden,v.checked=a),d=!1}function p(n){var u=i.getOptions(),r=n==rt||a,t;d=u.labelOverlay!==tt.hidden!==r,i.setView({mapTypeId:n,labelOverlay:r?tt.visible:tt.hidden}),t=i.getComponent("analyticsProxy"),t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function nt(n){return n===w||n===b}function ft(){for(var n=c.length;n--;)c[n].hideMenu()}function et(n){n.stopPropagation(),h(i,n),a=!a,v&&(v.checked=a),nt(l)&&p(l),vt&&c[1].hideMenuDelay(1e3)}function ot(t,r){var b=c.length,u=new hi(i,f,r),a,e,s,v;for(u.mapTypes=t,u.updateLabel(ut[t[0]].title),u.setMapType(t[0]),a=[],u.events=a,e=0;e<t.length;e++)s=t[e],s&&(v=new ci(s,l===s,p),u.addMenuItem(v,v.getElement()));for(var y=!1,w=[["clicklabel",function(n){h(i,n),ft(),p(u.getMapType())}],["clickicon",function(n){h(i,n),u.toggleMenu()}],["clickitem",function(n){h(i,n),ft()}],["mouseentericon",function(){u.showMenu()}],["mouseleaveicon",function(){u.hideMenuDelay(1)}],["mouseenterlabel",function(){y=!0}],["mouseleavelabel",function(){y=!1}],["mouseenter",function(){u.isShown()&&!y&&u.showMenu()}],["mouseleave",function(){u.hideMenuDelay(1e3)}],["show",function(){for(var n=c.length;n--;)u!=c[n]&&c[n].hideMenu();o(it,"showmaptypemenu",{menuPosition:b})}],["hide",function(){o(it,"hidemaptypemenu",{menuPosition:b})}]],e=w.length;e--;)a.push(n.addHandler(u,w[e][0],w[e][1]));return u}function lt(n){var f=r("div","NavBar_checkControl"),i=r("input"),e;return i.setAttribute("type","checkbox"),t(i).add_event("click",et),f.appendChild(i),i.checked=!0,e=r("span","",f),e.appendChild(document.createTextNode(u.getString("L_aerialShowLabels_Text"))),t(e).add_event("click",et),n.addMenuItem(null,f),i}var it=this,rt=k.auto,b=k.birdseye,w=k.aerial,l=i.getMapTypeId(),st=s,c=[],a,v;c.push(ot([k.road,y.allowCollinsBart?k.collinsBart:null,y.allowOrdnanceSurvey?k.ordnanceSurvey:null,rt],"NavBar_DropDownMenu_0")),a=!0,v=null,y.allowAerialMap&&(c.push(ot(st.disableBirdseye!==!0?[b,w]:[w],"NavBar_DropDownMenu_1")),v=lt(c[1]));var ht=n.addHandler(i,"maptypechanged",g),ct=n.addHandler(i,"optionschanged",g),d=!1;g(),this.dispose=function(){for(var t=c.length;t--;){for(var i=c[t],r=i.events,u=r.length;u--;)n.removeHandler(r[u]);i.dispose()}n.removeHandler(ht),n.removeHandler(ct)},this.showMenu=function(n){c[n].showMenu()},this.hideMenu=function(n){c[n].hideMenu()},this.getAerialViewSettings=function(){return{showLabels:a}},this.setAerialViewSettings=function(n,t){a=n,nt(l)&&(t?p(b):p(w))}}function sr(e,o,s){function ct(n){i(n),t.Events.capture_mouse(l),y=!0}function nt(n){d();var t=Math.min(1,n.touches.length);ht||n.touches.length!==1||(p=new f(n.touches[0].pageX,n.touches[0].pageY),p.target=n.target,p.start=new Date),k=new f(n.touches[0].pageX,n.touches[0].pageY),ht=k,y=!0,i(n)}function lt(n){if(i(n),y){var r=w(t.Screen.get_mouse_pos(n).y);l.style.top=r+"px",b(r,!0)}}function tt(n){if(d(),yt(),k=new f(n.touches[0].pageX,n.touches[0].pageY),y){var t=w(k.y);l.style.top=t+"px",b(t,!0)}i(n)}function at(n){i(n),y&&(t.Events.release_mouse(),y=!1,b(w(t.Screen.get_mouse_pos(n).y),!1),ut(),h(e,n))}function it(n){d(),p?(bt(n),h(e,n)):y&&(y=!1,b(w(k.y),!1),ut(),h(e,n)),yt()}function vt(n){i(n),b(w(t.Screen.get_mouse_pos(n).y)),h(e,n)}function bt(n){n.target===a&&b(w(p.y))}function yt(){p=null}function rt(){var n=e.getZoomRange();c&&c.min==n.min&&c.max==n.max||(c=n),ut()}function w(n){var i=a.offsetHeight-l.offsetHeight;return n-=t(a).get_absolute_pos().y+l.offsetHeight/2,n=Math.max(n,0),Math.min(n,i)}function b(n,t){var i=l.offsetHeight/2,r=a.offsetHeight-i,u=n+i,f=Math.round(c.max+(u-i)*-(c.max-c.min)/(r-i));e.setView({zoom:f,suspend:t})}function kt(n,t){if(c){var i=l.offsetHeight/2,r=a.offsetHeight-i,u=Math.round(i+(r-i)*(t-c.max)/-(c.max-c.min));n.style.top=u-n.offsetHeight/2+"px"}}function ut(){kt(l,e.getTargetZoom())}function pt(){g&&(window.clearTimeout(g),g=null)}function d(){pt(),ft&&(g=window.setTimeout(dt,5e3))}function dt(){pt(),o.style.display="none"}var gt=this,v,a,wt,l,ft=s,et,st,y,c,p,k,ht,g;v=r("div","NavBar_zoom"),ot(v),a=r("div","NavBar_zoomBar",v),a.style.cssText="position:absolute;overflow:hidden",t(a).add_event("click",vt).add_event("touchstart",nt).add_event("touchmove",tt).add_event("touchend",it),wt=r("div","NavBar_zoomBarBg",a),l=r("div","NavBar_zoomSlider",a),l.title=u.getString("L_zoomSliderTooltip_Text"),t(l).add_event("mousedown",ct).add_event("mouseup",at).add_event("mousemove",lt).add_event("click",i).add_event("touchstart",nt).add_event("touchmove",tt).add_event("touchend",it),t(v).add_event("mousedown",i).add_event("mouseup",i).add_event("mousemove",i).add_event("click",i).add_event("touchstart",i).add_event("touchmove",i).add_event("touchend",i),o.appendChild(v),et=n.addHandler(e,"targetviewchanged",rt),st=n.addHandler(e,"imagerychanged",rt),ft&&d(),this.getDomElement=function(){return v},this.dispose=function(){v&&(t(a).remove_event("click",vt).remove_event("touchstart",nt).remove_event("touchmove",tt).remove_event("touchend",it),t(l).remove_event("mousedown",ct).remove_event("mouseup",at).remove_event("mousemove",lt).remove_event("click",i).remove_event("touchstart",nt).remove_event("touchmove",tt).remove_event("touchend",it),t(v).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousemove",i).remove_event("click",i).remove_event("touchstart",i).remove_event("touchmove",i).remove_event("touchend",i),n.removeHandler(et),n.removeHandler(st),v.parentNode.removeChild(v),a=null,l=null,v=null)},this.show=function(){rt()},this.resetZoomBarTimer=d}function hr(u,f,e){function w(){s&&(n.removeHandler(a),n.removeHandler(s),s=null,v.removeNavigationBar(u))}function y(){var i=f.getDomElement(),r,n;i&&(r=i.offsetWidth,n="",r<=665?n="narrow":r<=774&&(n="medium"),n!==l&&(t(i).remove_class(l).add_class(n),l=n))}function p(n){var t,i,u;if(t=c[n],i=f.getDomElement(),!t){t=r("div","NavBar_clientRegion NavBar_clientRegion_"+b.getName(n));switch(n){case b.left:u=c[b.middle],i.insertBefore(t,u?u.nextSibling:e.getDomElement().nextSibling);break;case b.middle:t=e.getDomElement();break;case b.right:i.appendChild(t)}c[n]=t,y()}return t}var c={},o={},l="",s,a;v.registerNavigationBar(u,this),s=n.addHandler(u,"ondispose",w),a=n.addHandler(u,"resize",y),this.addClientButton=function(n,r,f,e,s){var l=p(n),c=typeof f=="string"?at(e,f):f;return l.appendChild(c),o[r]=c,t(c).add_event("click",function(n){typeof f=="string"&&i(n),h(u,n),s&&s(r)}).set_attr("uici","NB.TB."+f),c},this.updateClientButton=function(n,i,r){var u=o[n];u&&(u.className="NavBar_button NavBar_toolButton "+(r||""),u.title=i||"",t(u).set_attr("uici","NB.TB."+i))},this.removeClientButton=function(n,t){var r=p(n),i=o[t];i&&(delete o[t],r.removeChild(i))}}function cr(f,o,s){function di(){n.removeHandler(at),at=null,wi=f.getTargetCenter(),bi=f.getTargetZoom()}function pt(){ui&&(f.entities.remove(ui),ui=null),c.current.style.display!=="none"&&(c.current.style.display="none",c.currentDelim.style.display="none",g=p[d],y())}function gi(){c.current.style.display==="none"&&(l.currentZoom=f.getTargetZoom(),l.currentCenter=f.getTargetCenter(),c.current.style.display="inline-block",c.currentDelim.style.display="inline",y())}function tu(n){ti=n,y()}function nr(){ft=ti!==null?ti:iu()}function iu(){var r=c.breadcrumbContainer,u=c.breadcrumb,n,i;return u&&r?(n=t(u),i=r.offsetWidth-parseInt(n.get_style("paddingLeft"))-parseInt(n.get_style("paddingRight")),i>0?i:0):0}function ru(){y()}function uu(){var t,n,i;if(nr(),ft<=0){c.breadcrumb&&(c.breadcrumb.style.display="none");return}if(c.breadcrumb&&(c.breadcrumb.style.display="block"),t=c.breadcrumbBar.offsetWidth,t>=ft)for(n=0,i=p.length-1;n<i;n++)if(c[p[n]].firstChild.nodeValue="...",c[p[n]].setAttribute("title",l[p[n]]),t=c.breadcrumbBar.offsetWidth,t<ft)break;fu()}function fu(){var t,n,i;if(nr(),ft<=0){c.breadcrumb&&(c.breadcrumb.style.display="none");return}if(c.breadcrumb&&(c.breadcrumb.style.display="block"),t=c.breadcrumbBar.offsetWidth,t>=ft)for(n=0,i=w.length;n<i;n++)if(a[w[n].name].firstChild.nodeValue="...",a[w[n].name].setAttribute("title",w[n].value),t=c.breadcrumbBar.offsetWidth,t<ft)break;vr(it)}function tr(){c.breadcrumb&&(yi(c.breadcrumbContainer),c.breadcrumbContainer.parentNode.removeChild(c.breadcrumbContainer),c.breadcrumbContainer=null,c.breadcrumb=null)}function eu(t){var u=a[t+"Delim"],f,i,r;u&&(u.parentNode.removeChild(u),a[t+"Delim"]=null),f=lt(t),f.type==="group"?(i=t+"Click",n.removeHandler(b[i]),b[i]=null,i=t+"MouseEnter",n.removeHandler(b[i]),b[i]=null,i=t+"MouseLeave",n.removeHandler(b[i]),b[i]=null,f===it&&ut(!0),r=a[t+"Container"],a[t+"Container"]=null,a[t]=null,a[t+"ListSign"]=null,r.parentNode.removeChild(r)):(i=t+"Click",n.removeHandler(b[i]),b[i]=null,r=a[t],a[t]=null,r.parentNode.removeChild(r))}function ou(t){var i,r,u;g=t,y();switch(t){case"world":case"country":case"state":case"county":case"city":case"neighborhood":gi();break;case"current":pt();break;default:n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:lt(t).value});return}i={animate:gr},f.isStreetside&&f.isStreetside()&&(i.mapTypeId=k.road),r=l[t+"Bounds"],r?(u=dt.fromEdges(r[2],r[1],r[0],r[3]),i.bounds=u):t==="current"?(i.center=l.currentCenter,i.zoom=l.currentZoom):(i.center=l.currentCenter,i.zoom=l[t+"Zoom"]),yu(i),n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:l[t]})}function ir(){ou(this.attributes.pathNodeLevel.value)}function rr(){var h,n,u,e;c.root||(c.root=f.getRootElement(),h=r("div","pathContainer"),c.breadcrumb=h,h.setAttribute("onselectstart","return false;"),n=r("div",s.getClassName(),o),s.getDomElement=function(){return n},ot(n),c.breadcrumbContainer=n,n.appendChild(c.breadcrumb),u=document.createElement("div"),u.className="unlockButton",e=t(u),e.add_event("click",hr),e.add_event("touchstart",i),e.add_event("touchend",hr),c.root.appendChild(u),c.breadcrumbUnlock=u,su())}function su(){var f,i,r,o,e,n;if(c.breadcrumb){f=document.createElement("span"),f.className="path";for(i in et)r=document.createElement("span"),i!=="world"?(i==="current"&&(o=document.createElement("span"),f.appendChild(o),c.breadcrumbExtension=o),e="•",r.className="pathNodeDelim",r.style.display="none"):(e="",r.className="pathHeight",r.style.display="inline-block"),r.appendChild(document.createTextNode(e)),f.appendChild(r),c[i+"Delim"]=r,i==="current"?(n=document.createElement("a"),n.className="currentIcon",n.href="#",n.title=u.getString("L_currentIconTooltip_Text")):(n=document.createElement("a"),n.href="#",n.className="pathNode",i!=="world"?n.appendChild(document.createTextNode("")):n.appendChild(document.createTextNode(l[i]))),i!=="world"&&(n.style.display="none"),t(n).add_event("click",ir),n.setAttribute("pathNodeLevel",i),n.setAttribute("uici","BC.PN."+i),f.appendChild(n),c[i]=n;c.breadcrumbBar=f,c.breadcrumb.appendChild(f)}}function ur(){h.country=null,h.state=null,h.county=null,h.city=null,h.neighborhood=null,h.street=null,h.current=null,h.countryBounds=null,h.stateBounds=null,h.countyBounds=null,h.cityBounds=null,h.neighborhoodBounds=null,h.streetBounds=null,h.currentBounds=null,h.countryEntityId=null,h.stateEntityId=null,h.countyEntityId=null,h.cityEntityId=null,h.neighborhoodEntityId=null,h.streetEntityId=null,h.currentEntityId=null}function fr(){c.breadcrumbUnlock.style.display="block"}function er(){c.breadcrumbUnlock.style.display="none"}function hu(n,t,i,r,u){var f={type:n,name:t,value:i,values:r,isVisible:u};w.push(f),cu(f)}function cu(n){var u=document.createElement("span"),r,f,i;u.className="pathNodeDelim",u.style.display="none",u.appendChild(document.createTextNode("•")),a[n.name+"Delim"]=u,c.breadcrumbExtension.appendChild(u),n.type==="group"?(r=document.createElement("span"),r.className="groupContainer",r.style.display="none",r.setAttribute("pathNodeLevel",n.name),b[n.name+"Click"]=t(r).add_event("click",bu),b[n.name+"MouseEnter"]=t(r).add_event("mouseenter",cr),b[n.name+"MouseLeave"]=t(r).add_event("mouseleave",lr),i=document.createElement("span"),i.className="group",i.appendChild(document.createTextNode("")),f=document.createElement("span"),f.className="groupListSign",a[n.name+"Container"]=r,a[n.name]=i,a[n.name+"ListSign"]=f,r.appendChild(i),r.appendChild(f),c.breadcrumbExtension.appendChild(r)):(i=document.createElement("span"),i.className="pathNode",i.appendChild(document.createTextNode("")),i.style.display="none",b[n.name+"Click"]=t(i).add_event("click",ir),i.setAttribute("pathNodeLevel",n.name),i.setAttribute("uici","BC.PN."+n.name),a[n.name]=i,c.breadcrumbExtension.appendChild(i))}function lu(n,t){var i=lt(n);i.isVisible!==t&&(i.type==="group"&&t===!1&&i===it&&ut(!0),i.isVisible=t,y())}function au(n){eu(n),w.splice(vu(n),1),y()}function lt(n){for(var t=w.length;t--;)if(w[t].name===n)return w[t]}function vu(n){for(var t=w.length;t--;)if(w[t].name===n)return t}function or(t,i){var r=lt(t),u=r.value;r.value=i,a[t].firstChild.nodeValue=i,hi(t),y(),n.invoke(v,"groupselecteditemchanged",{groupName:t,newItem:i,oldItem:u})}function sr(t){ct=!0,ht=t,bt(!0),n.invoke(v,"locked")}function yu(t){at||(at=n.addHandler(f,"targetviewchanged",di)),f.setView(t),window.setTimeout(function(){at&&di()},100)}function pu(){ct=!1}function wu(){ct=!1,er(),ut(!0),pt(),ur(),h.currentZoom=f.getTargetZoom(),wr(),g=p[d],y(),ht=f.getTargetCenter(),bt(!0),n.invoke(v,"unlocked")}function hr(t){wu(),n.invoke(v,"closed"),t.stopPropagation()}function bu(){var t=this.attributes.pathNodeLevel.value,i=lt(t);hi(t),y(),a.groupList?ut(!0):yr(i),n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:i.value})}function cr(){yr(lt(this.attributes.pathNodeLevel.value))}function lr(){a.groupList&&ut()}function wt(n){or(it.name,this.firstChild.nodeValue),ut(!0),i(n)}function ar(){var u,f,r;if(tt=null,a.groupList){for(n.removeHandler(ii),n.removeHandler(ri),u=a.groupList.childNodes,f=u.length;f--;)r=t(u[f]),r.remove_event("click",wt),r.remove_event("touchstart",i),r.remove_event("touchend",wt);ii=null,ri=null,a.groupList.parentNode.removeChild(a.groupList),a.groupList=null,it=null}}function ut(n){a.groupList&&(n?(tt&&(clearTimeout(tt),tt=null),ar()):tt||(tt=setTimeout(ar,1e3)))}function vr(n){var i=a.groupList;if(i){var r=t(o).get_absolute_pos(),u=c.breadcrumb,f=t(u).get_absolute_pos().y+u.offsetHeight-r.y,e=t(a[n.name+"Container"]).get_absolute_pos().x-r.x;i.style.top=f+"px",i.style.left=e+"px"}}function yr(n){var r,e,u,f;if(it)if(it!==n)ut(!0);else{tt&&(clearTimeout(tt),tt=null);return}r=document.createElement("ul"),a.groupList=r,it=n,r.className="pathList",r.style.position="absolute",r.setAttribute("pathNodeLevel",n.name),o.appendChild(r),ii=t(r).add_event("mouseenter",cr),ri=t(r).add_event("mouseleave",lr);for(e in n.values)u=document.createElement("li"),u.appendChild(document.createTextNode(n.values[e])),r.appendChild(u),f=t(u),f.add_event("click",wt),f.add_event("touchstart",i),f.add_event("touchend",wt);vr(n)}function ku(){l.country=null,l.state=null,l.county=null,l.city=null,l.neighborhood=null,l.street=null,l.current=null,l.countryBounds=null,l.stateBounds=null,l.countyBounds=null,l.cityBounds=null,l.neighborhoodBounds=null,l.streetBounds=null,l.currentBounds=null,l.countryEntityId=null,l.stateEntityId=null,l.countyEntityId=null,l.cityEntityId=null,l.neighborhoodEntityId=null,l.streetEntityId=null,l.currentEntityId=null,d=et.world,g="world"}function ei(){fi=vi,st++,f.getCredentials(function(n){if(n){var t=ci+"/"+ht.latitude.toFixed(10)+","+ht.longitude.toFixed(10)+"?include=EntityId&includeEntityTypes=Neighborhood,PopulatedPlace,AdminDivision1,AdminDivision2,CountryRegion&output=json&key="+n+"&culture="+ni;rt.useXHR||(t+="&jsonp=microsoftMapsNetworkCallback&jsonso={jsono}"),yt.getObjectAsync(t,nf,st)}})}function bt(n,t){n?(clearTimeout(nt),nt=null,ei()):(fi===pi&&nt&&(clearTimeout(nt),nt=null),st++,fi=pi,nt=t?setTimeout(ei,t):setTimeout(ei,nu))}function oi(n){for(var i="",r=et[n]+1,t;r-->1;){var u=p[r],e=du[u],o=h[u];if(e&&o)i+="&"+e+"="+o;else{si();return}}n!=="street"&&(t=ki.get(h[n+"EntityId"])),t?(h[n+"Bounds"]=t,si()):f.getCredentials(function(n){if(n){var t=ci+"?key="+n+"&culture="+ni+"&output=json"+i;rt.useXHR||(t+="&jsonp=microsoftMapsNetworkCallback&jsonso={jsono}"),yt.getObjectAsync(t,uf,st)}})}function y(){var e=et,f,n,i,r;vt.selectedCrumb=g;for(n in e)i=c[n],n!=="current"&&(n==="street"?i.firstChild.nodeValue=u.getString("L_breadcrumbNear_Text").replace("{0}",l[n]):(f=l[n],f||(f=""),i.firstChild.nodeValue=f),i.removeAttribute("title"),r=c[n+"Delim"],et[n]>d&&!ct||!l[n]?(i&&(i.style.display="none"),r&&n!=="world"&&(r.style.display="none")):(i&&(i.style.display="inline",n===g?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&n!=="world"&&(r.style.display="inline")));gu(),uu()}function gu(){for(var n,i,r,u=0,f=w.length;u<f;u++)n=w[u],i=a[n.name],i.firstChild.nodeValue=n.value,i.removeAttribute("title"),r=a[n.name+"Delim"],n.isVisible?(i&&(n.type==="group"?a[n.name+"Container"].style.display="inline":i.style.display="inline",n.name===g?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&(r.style.display="inline")):(i&&(n.type==="group"?(a[n.name+"Container"].style.display="none",ut(!0)):i.style.display="none"),r&&(r.style.display="none"))}function nf(n,t){var c=t.userData,e,o,f,s,r,u,i;if(c===st&&t.success&&n.statusCode===200){if(e=n.resourceSets[0],o=!1,e.estimatedTotal>0){for(f=e.resources,ur(),r=f.length;r--;)if(u=f[r],s=u.entityType,pr[s]&&s!=="Neighborhood"){i=u.address,h.country=i.countryRegion,h.state=i.adminDistrict,h.county=i.adminDistrict2,h.city=i.locality,h.street=i.addressLine,h.countryEntityId=i.countryRegionEntityId,h.stateEntityId=i.adminDistrictEntityId,h.countyEntityId=i.adminDistrict2EntityId,h.cityEntityId=i.localityEntityId,h.streetEntityId=i.addressLineEntityId;break}for(r=f.length;r--;)if(u=f[r],u.entityType==="Neighborhood"){i=u.address,h.country=i.countryRegion,h.state=i.adminDistrict,h.county=i.adminDistrict2,h.neighborhood=i.locality,h.countryEntityId=i.countryRegionEntityId,h.stateEntityId=i.adminDistrictEntityId,h.countyEntityId=i.adminDistrict2EntityId,h.neighborhoodEntityId=i.localityEntityId;break}o=!0}else ku(),y();vt={currentCrumb:p[d],selectedCrumb:g,country:h.country,state:h.state,county:h.county,neighborhood:h.neighborhood,city:h.city,street:h.street,location:n},o&&rf()}}function tf(n,t){var i=pr[n];h[i+"Bounds"]=t,ki.add(h[i+"EntityId"],t)}function rf(){li=3,oi("city"),oi("state"),oi("country")}function uf(n,t){var r=t.userData,i;r===st&&t.success&&n&&n.statusCode===200&&n.resourceSets&&n.resourceSets.length>0&&n.resourceSets[0].resources&&n.resourceSets[0].resources.length>0&&(i=n.resourceSets[0].resources[0],tf(i.entityType,i.bbox)),si()}function si(){--li||(l=h,wr(),vt.currentCrumb=p[d],n.invoke(v,"breadcrumbschanged"),y())}function ff(n){var t=f.getBounds();return!(n.width>t.width||n.height>t.height)}function ef(n){var t=f.getBounds(),i=Math.min(t.width/4,t.height/4);return n.width>=i||n.height>=i}function wr(){var n,u,t,i,f,r;if(ct){d=et.neighborhood;return}for(n=0,u=p.length-1;n<u;n++)if(l[p[n]])if(t=l[p[n]+"Bounds"],t)if(i=dt.fromEdges(t[2],t[1],t[0],t[3]),ff(i)){f=i,ef(i)&&(d=n);break}else d=n;else if(r=l[p[n]+"Zoom"],r)if(r>=l.currentZoom){if(r<l.currentZoom+2){d=n;break}}else d=n;g=p[d]}function of(){rr(),ht=f.getTargetCenter(),h.currentZoom=f.getTargetZoom(),bt(!1,5e3),ai=n.addHandler(f,"viewchangeend",sf)}function sf(){gt.areEqual(f.getTargetCenter(),wi)&&f.getTargetZoom()===bi||(pt(),ct===!1?(ht=f.getCenter(),h.currentZoom=f.getZoom(),bt()):y())}function hi(n){g!==n&&(g=n,y())}function br(){nt&&(clearTimeout(nt),nt=null),n.removeHandler(ai),tr()}function dr(){kt&&(n.removeHandler(kt),kt=null,br(),f.addComponent("breadcrumb",v))}var ci=e.Globals.bingMapsRESTServicesUrl,ni="en-us",li=0,ft=0,ti=null,st=0,ht,it,ii=null,ri=null,b={},ui,gr=!0,v=this,ct=!1,ai,vt={},g="world",vi="ready",pi="wait",fi=vi,wi,bi,at,nt,nu=1e3,tt,w=[],l={world:u.getString("L_world_Text"),worldBounds:[-75,-175,75,175],countryZoom:4,stateZoom:7,countyZoom:10,cityZoom:13,neighborhoodZoom:15,streetZoom:16,current:""},h=l,et={world:0,country:1,state:2,county:3,city:4,neighborhood:5,street:6,current:7},p=["world","country","state","county","city","neighborhood","street","current"],d=et.world,c={},a={},ki={_cacheSize:100,_history:[],_recentlyUsed:[],_cache:{},add:function(n,t){n&&(this._cache[n]=t,this._history.push(n),this._history.length>this._cacheSize&&delete this._cache[this._history.shift()])},get:function(n){return n?this._cache[n]:null}},du={street:"addressLine",city:"locality",county:"adminDistrict2",state:"adminDistrict",country:"countryRegion"},pr={Dependent:"country",Sovereign:"country",CountryRegion:"country",AdminDivision1:"state",AdminDivision2:"county",PopulatedPlace:"city",Neighborhood:"neighborhood",Address:"street"},kr=e.Globals.locale,kt;kr&&(ni=kr.toLowerCase()),n.addHandler(f,"resize",ru),f.addComponent("breadcrumb",v),kt=n.addHandler(f,"ondispose",dr),v.enable=of,v.disable=br,v.dispose=dr,v.setWidth=tu,v.lockToLocation=sr,v.unlockFromLocation=pu,v.showCloseButton=fr,v.hideCloseButton=er,v.addCrumb=hu,v.removeCrumb=au,v.setVisibility=lu,v.selectGroupItem=or,v.highlightCrumb=hi,v.showBookmark=gi,v.hideBookmark=pt,v.relocateCloseButton=function(n,t){c.breadcrumbUnlock.style.top=n,c.breadcrumbUnlock.style.right=t},v.getBreadcrumbs=function(){return vt},this.enable()}function lr(f,e,o){function nt(){b&&(n.removeHandler(b),b=null,a&&a.dispose(),t(p).remove_event("click",it).remove_event("mouseenter",l).remove_event("mouseleave",v),t(y).remove_event("click",tt).remove_event("mouseenter",l).remove_event("mouseleave",v),s.parentNode.removeChild(s))}function tt(n){i(n),h(f,n),vt()?l():d(),f.setView({zoom:f.getTargetZoom()+1})}function it(n){i(n),h(f,n),vt()?l():d(),f.setView({zoom:f.getTargetZoom()-1})}function l(){g(),o.getZoomBarVisible()&&(c||(c=r("div","NavBar_zoomDrop"),c.style.cssText="position:absolute;display:none;",a=new sr(f,c,o.getZoomBarToggle()),s.firstChild?s.insertBefore(c,s.firstChild):s.appendChild(c),o.getZoomBarToggle()&&t(c).add_event("mouseenter",l).add_event("mouseleave",v)),c.style.display==="none"&&(c.style.display="",a.show()),vt()&&a.resetZoomBarTimer())}function v(){g(),w=window.setTimeout(d,1e3)}function d(){g(),o.getZoomBarToggle()&&c&&(c.style.display="none")}function g(){w&&(window.clearTimeout(w),w=null),k&&(window.clearTimeout(k),k=null)}var rt=this,s,y,p,c,a,w,k,b;s=r("div",o.getClassName()),ot(s),p=at("NavBar_zoomOut",u.getString("L_zoomOutTooltip_Text")),t(p).add_event("click",it).add_event("mouseenter",l).add_event("mouseleave",v).set_attr("uici","NB.ZC.ZoomOut"),y=at("NavBar_zoomIn",u.getString("L_zoomInTooltip_Text")),t(y).add_event("click",tt).add_event("mouseenter",l).add_event("mouseleave",v).set_attr("uici","NB.ZC.ZoomIn"),o.getZoomOutVisible()&&s.appendChild(p),o.getZoomInVisible()&&s.appendChild(y),e.appendChild(s),o.getZoomBarToggle()||l(),o.getDomElement=function(){return s},b=n.addHandler(f,"ondispose",nt),this.dispose=nt}function ar(t,i,u){function a(){if(h){n.removeHandler(h),h=null;for(var t=e.length;t--;)n.removeHandler(e[t][2]);c.dispose(),f.parentNode.removeChild(f)}}var e=[["showmaptypemenu",function(n){o(v.getNavBar(t),"showmaptypemenu",n)}],["hidemaptypemenu",function(n){o(v.getNavBar(t),"hidemaptypemenu",n)}]],c,f=r("div",u.getClassName()),y,l,s,h;for(ot(f),y=r("span","NavBar_separator",f),l={disableBirdseye:u.getDisableBirdseye()},c=u.getMapTypes()!==null?new or(t,f,this,l):new er(t,f,this,l),i.appendChild(f),u.getDomElement=function(){return f},s=e.length;s--;)e[s][2]=n.addHandler(c,e[s][0],e[s][1]);h=n.addHandler(t,"ondispose",a),this.dispose=a}function vr(t,i,u){function p(){a&&(n.removeHandler(a),n.removeHandler(b),a=null,f.parentNode.removeChild(f)),v&&n.removeHandler(v),y&&n.removeHandler(y)}for(var o=new d,f=r("div",u.getClassName()),w=u.getLength(),s,h,l,e=0;e<w;e++)s=u.get(e),h=c.getRenderer(s),typeof h=="function"&&new h(t,f,s);u.getStopPropagation()&&ot(f),i=u.getParentOverride()||i,l=u.getNextSibling(),l?i.insertBefore(f,l):i.appendChild(f),u.getDomElement=function(){return f},o.setContext(f);var b=n.addHandler(u,"entitychanged",function(n){n&&n.entity==u&&(n.handled=!0,f.className=u.getClassName(),u.getStopPropagation()?ot(f):yi(f))}),v=n.addHandler(u,"entityadded",function(n){if(n&&n.collection==u){var i=n.entity,r=c.getRenderer(i);typeof r=="function"&&new r(t,f,i),o.insert(i,n.index)}}),y=n.addHandler(u,"entityremoved",function(n){o.remove(n.entity)}),a=n.addHandler(t,"ondispose",p);this.dispose=p}function d(n){function e(n){var t=document.createElement("div");return t.className="item",t.style.marginRight="1px",t.entity=n,t}function o(n){for(var t=n.length;t--;)s(n[t])}function s(n){n.parentNode&&n.parentNode.removeChild(n)}function u(n){var s,o,u,e,h;if(r){for(s=n===d.Layout.TopBottom||n===d.Layout.BottomTop?"none":"left",((i===d.Layout.TopBottom||i===d.Layout.LeftRight)&&(n===d.Layout.BottomTop||n===d.Layout.RightLeft)||(i===d.Layout.BottomTop||i===d.Layout.RightLeft)&&(n===d.Layout.TopBottom||n===d.Layout.LeftRight))&&t.reverse(),o=0;o<t.length;o++)u=t[o],u.wrapped||(e=u.entity,h=e&&e.getDomElement&&e.getDomElement(),h?u.appendChild(h):u.appendChild(e),u.wrapped=!0),u.style.cssFloat!==undefined?u.style.cssFloat=s:u.style.styleFloat!==undefined&&(u.style.styleFloat=s),r.appendChild(u);r.appendChild(f)}}var r=n,t=[],i=d.Layout.TopBottom,f=document.createElement("span");f.style.cssText="display:block;height:0;width:0;line-height:0;font-size:0;clear:both;",this.setContext=function(n){r||(r=n,u(i))},this.add=function(n){var r=e(n);t.push(r),u(i)},this.insert=function(n,r){var f=e(n);t.splice(r,0,f),u(i)},this.pop=function(){s(t.pop())},this.removeAt=function(n){o(t.splice(n,1))},this.remove=function(n){for(var i=t.length;i--;)if(t[i].entity===n){this.removeAt(i);break}},this.clear=function(){o(t),t.length=0},this.setLayout=function(n){n!==i&&(u(n),i=n)}}function li(n){var i=document.createElement("span");t(i).add_class("shadowtextDark"),n.appendChild(i),this.setColorsForDarkBackground=function(){t(i).swap_class("shadowtextDark","shadowtextLight")},this.setColorsForLightBackground=function(){t(i).swap_class("shadowtextLight","shadowtextDark")},this.setHtmlContent=function(n){i.innerHTML=n},this.setTextContent=function(n){i.innerHTML="",i.appendChild(document.createTextNode(n))}}function yr(t,i,u){function a(){p(),e=window.setTimeout(k,b)}function p(){e!=null&&window.clearTimeout(e)}function k(){e=null,f.getCopyrights(d)}function d(i,r){r!==l&&(l=r,n.invoke(t,"logorequirementschanged",{showCombinedLogo:l}));for(var f=i.concat(c).sort(function(n,t){return(n||"").length>(t||"").length}),e=f.length,u=0;u<e;u++)f[u]&&(f[u]='<span class = "copyrightAttribution">'+f[u]+"<\/span>");h.setHtmlContent(f.join(""))}function v(){g.getImageryBackground(t.getImageryId())===g.light?h.setColorsForLightBackground():h.setColorsForDarkBackground()}function nt(){if(s){n.removeHandler(s),s=null;for(var t=o.length;t--;)n.removeHandler(o[t]);o.length=0}}var y=r("div",u.getClassName(),i),o,s,w;u.getDomElement=function(){return y};var h=new li(y),f=t,c=[],e=null,b=1e3,l=null;a(),v(),o=[n.addThrottledHandler(f,"copyrightchanged",a,2e3),n.addHandler(f,"imagerychanged",v),n.addHandler(f,"modechanged",v),n.addHandler(f,"viewchangestart",p)],s=n.addHandler(t,"ondispose",nt),w=new function(){this.get_customAttributions=function(){return c},this.set_customAttributions=function(n){c=n,a()}},t.addComponent("copyright",w)}function pr(i,f,e){function ii(){var d,b,k,f,y;it=n.addHandler(i,"ondispose",ri),a=r("div",e.getClassName(),ni),e.getDomElement=function(){return a},l=t(a),(lt||at)&&l.add_event("mouseover",ht).add_event("mouseout",ct).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s).add_event("click",s),o=document.createElement("a"),o.href="http://www.bing.com",o.title=u.getString("L_BingLogoTooltip_Text"),o.target="mc_bingMaps",lt?n.addHandler(i,"viewchangeend",yt):(o.onclick=function(){return!1},o.style.cursor="default",o.tabIndex=-1),nt=document.createElement("span"),nt.id="bingLogo",o.appendChild(nt),v=document.createElement("span"),v.id="cobrandLogo",v.style.display="none",o.appendChild(v),d=document.createElement("span"),d.className="ms-clear",d.style.cssText="float: none !important",o.appendChild(d),a.appendChild(o),n.addHandler(i,"imagerychanged",ft),n.addHandler(i,"maptypechanged",ft),n.addHandler(i,"logorequirementschanged",pt),ft(),pt({showCombinedLogo:!1}),at&&(b=document.createElement("div"),b.className="LogoSearchContainer",k=document.createElement("div"),k.className="LogoSearchGroup",b.appendChild(k),f=document.createElement("input"),f.id="LogoSearchInput",f.type="text",rt.useXHR&&(f.style.margin="0"),f.maxLength=60,f.className="watermark",f.value=u.getString("L_BingSearchWatermark_Text"),w=!0,k.appendChild(f),y=document.createElement("input"),y.id="LogoSearchGo",rt.useXHR||(y.type="button"),y.title=u.getString("L_BingSearchGoTooltip_Text"),k.appendChild(y),h=t(b),h.set_style({display:"none"}),p=!1,t(o).add_event("focus",ht).add_event("blur",ct).add_event("keypress",oi),h.add_event("mouseover",wt).add_event("mouseout",bt).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s),tt=t(y),tt.add_event("blur",et).add_event("focus",ot).add_event("click",st),c=t(f),c.add_event("blur",kt).add_event("focus",dt).add_event("keydown",gt),a.appendChild(b))}function ri(){it&&(n.removeHandler(it),it=null),o&&n.removeHandler(yt),l&&l.remove_event("mouseover",ht).remove_event("mouseout",ct).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s).remove_event("click",s),a.parentNode.removeChild(a),h&&(h.remove_event("mouseover",wt).remove_event("mouseout",bt).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s),tt.remove_event("blur",et).remove_event("focus",ot).remove_event("click",st),c.remove_event("blur",kt).remove_event("focus",dt).remove_event("keydown",gt),h.element().parentNode.removeChild(h.element())),d(),o=null,nt=null,v=null,a=null,tt=null,c=null,h=null}function d(){h&&k&&(window.clearTimeout(k),k=null)}function ut(){h&&b&&(d(),k=window.setTimeout(fi,2e3))}function vt(){w||c.element().value||(c.element().value=u.getString("L_BingSearchWatermark_Text"),c.add_class("watermark"),w=!0)}function ui(){w&&(c.element().value="",c.remove_class("watermark"),w=!1)}function fi(){k=null,ei(),b=!1}function ei(){h.set_style({display:"none"}),l.remove_class("Active"),h.set_style("width",null)}function yt(){if(o){var n=i.getCenter();n&&(o.href=y.logoBingMapsLink.replace("{0}",n.latitude).replace("{1}",n.longitude).replace("{2}",i.getZoom()))}}function pt(n){t(v).set_style({display:n.showCombinedLogo?"":"none"}),l.set_style({display:ti&&!n.showCombinedLogo?"none":""})}function ft(){g.getImageryBackground(i.getImageryId())===g.dark?l.add_class("dark"):l.remove_class("dark")}function wt(){d()}function bt(){p||ut()}function oi(n){n.charCode&&(c[0].focus(),c.set_val(String.fromCharCode(n.charCode)))}function et(){p=!1,ut()}function ot(){p=!0,d()}function kt(n){et(n),vt()}function dt(n){ot(n),ui()}function st(){var n=c.element().value,t;!w&&typeof n=="string"&&n.length>0&&(c.element().value="",vt(),n=encodeURIComponent?encodeURIComponent(n):ur.encodeUrl(n),t=y.logoBingSearchUrl.replace("{0}",n),window.open(t,"mc_bingSearch"),ut())}function gt(n){p&&n.keyCode===13&&st()}function ht(){d(),h&&!b&&(h.set_style({display:""}),b=!0,l.add_class("Active"))}function ct(){h?b&&!p&&ut():l.remove_class("Active")}var ni=f,lt=e.getClickable(),at=e.getEnableSearch(),ti=e.getShowCombinedOnly(),si=this,nt=null,v=null,b=!1,p=!1,w=!1,k=null,l=null,h=null,c=null,tt=null,a=null,o=null,it;ii()}function ai(n,i){function p(n){for(var r=Math.floor(n),i,t=0;t<a.length;t++)if(i=a[t],r>i)return i;return 1}function w(n,t){for(var r,i=0;i<v.length;i++)if(r=v[i],n>r)return r*t;return t}function r(n){var r=Math.log(n)/y,u=Math.floor(r),t=Math.pow(10,u),i=n/t;return 1===t?p(i):w(i,t)}var y=2.3025850929940459,f=n,h=i,c=0,l=0,a=[5,2],v=[5,2.5,2],o,e,s;t(f).add_class("ScaleBar"),o=document.createElement("span"),f.appendChild(o),e=new li(o),s=document.createElement("span"),s.className="scalerect",f.appendChild(s),this.getMaxWidth=function(){return c},this.setMaxWidth=function(n){return c=n,n},this.getActualWidth=function(){return l},this.setActualWidth=function(n){return l=n,n},this.setColorsForBackground=function(n){n===g.light?e.setColorsForLightBackground():e.setColorsForDarkBackground()},this.setScale=function(n){var i,t,f,s,e,o;h===ct.kilometersMeters?(s=n*this.getMaxWidth(),s>nt.metersPerKm?(t=r(s/nt.metersPerKm),i=Math.floor(t*nt.metersPerKm/n),f=u.getString("L_scaleBarKilometers_Text")):(t=r(s),i=Math.floor(t/n),f=u.getString("L_scaleBarMeters_Text"))):(e=n*nt.feetPerMeter,o=e*this.getMaxWidth(),o>nt.feetPerMile?(t=r(o/nt.feetPerMile),i=Math.floor(t*nt.feetPerMile/e),f=u.getString("L_scaleBarMiles_Text")):h===ct.milesFeet?(t=r(o),i=Math.floor(t/e),f=u.getString("L_scaleBarFeet_Text")):(t=r(o/nt.feetPerYard),i=Math.floor(t*nt.feetPerYard/e),f=u.getString("L_scaleBarYards_Text"))),this.setControlScale(i,f.replace("{num}",t))},this.setControlScale=function(n,t){this.setActualWidth(n+2),f.style.width=this.getActualWidth().toFixed()+"px",e.setTextContent(t)}}function wr(n){var e=200,u=n,i,f,r;t(u).add_class("DoubleScaleBar"),_scaleBarMiElement=document.createElement("span"),i=new ai(_scaleBarMiElement,ct.milesFeet),i.setMaxWidth(e/2),u.appendChild(_scaleBarMiElement),f=document.createElement("span"),r=new ai(f,ct.kilometersMeters),r.setMaxWidth(e/2),u.appendChild(f),this.setColorsForBackground=function(n){r.setColorsForBackground(n),i.setColorsForBackground(n)},this.setScale=function(n){r.setScale(n),i.setScale(n)}}function br(t,i,u){function h(){f.setScale(t.getMetersPerPixel())}function c(){f.setColorsForBackground(g.getImageryBackground(t.getImageryId()))}function l(){if(o){n.removeHandler(o),o=null;for(var t=e.length;t--;)n.removeHandler(e[t]);e.length=0}}var s=r("div",u.getClassName(),i),f,e,o;u.getDomElement=function(){return s},f=new wr(s),f.setScale(t.getMetersPerPixel()),e=[n.addHandler(t,"viewchangeend",h),n.addHandler(t,"imagerychanged",c),n.addHandler(t,"modechanged",h)],o=n.addHandler(t,"ondispose",l)}function kr(i,r){function ut(){var n=i.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function ft(){var n=i.getOptions();return!(n.disableZooming||n.disableMouseInput||n.disableUserInput)}function kt(n){var t=Math.round(i.getTargetZoom()),r=1<<t,u=new pt(t,Math.floor(n.x*r),Math.floor(n.y*r));return ni.fromTileId(u,!1)}function ti(){var n=i.getOptions().labelOverlay;nt=n===tt.hidden?!0:r}function ii(){var n=null,t=i.getImageryId();switch(t){case"Road":n=ui;break;case"Aerial":n=fi;break;case"EnhancedBirdseye":case"NativeBirdseye":u.removeLayer(a),a=null;break;default:h.removeLayer(a),a=null,vt()}n!==a&&(at(),h.removeLayer(a),h.addLayer(n),a=n,et())}function ei(n){d=n}function oi(){s&&(n.removeHandler(s),s=null,c||(d=null,c=n.addHandler(i,"mousemove",ei)),o&&ht())}function et(){c&&(n.removeHandler(c),c=null),s||(s=n.addHandler(i,"mousemove",ct));var t=Math.round(i.getTargetZoom()),r=p.getMapTargetMercatorBounds(i);h.loadQuadkeysForMercatorBounds(r,t),d&&(ct(d),d=null)}function si(n){return v&&(window.clearTimeout(v),v=null),n.handled=!1,!1}function hi(n){if(n.targetType!=="map"&&n.target.pointerEvents!=="none"||n.mouseMoved)return n.handled=!1,!1;if(v)return n.handled=!0,!0;var i=new f(n.getX(),n.getY()),t=st(i);return t?(v=window.setTimeout(function(){ci(t.hotRegion,i,t.worldPoint)},250),n.handled=!0,!0):(n.handled=!1,!1)}function ci(t,r,f){var s,h,w,o;if(v=null,s={hotRegion:t,cancelDefault:!1,clickLocation:i.tryPixelToLocation(r,null,{normalizeLongitude:!1})},n.invoke(u,"click",s),h=t.bmv,!s.cancelDefault&&h){var c=h.tl,l=h.br,b=h.z,a=h.c,y=360*Math.floor(f.x),p=180*Math.floor(f.y),e;c&&l?(w=dt.fromEdges(c.y+p,c.x+y,l.y+p,l.x+y),ot(w.center,s.clickLocation),e={bounds:w,animate:!0},ut()||(o=i.getCenter(),ot(o,s.clickLocation),e.center=o),ft()||(e.center=e.center||e.bounds.center,delete e.bounds),i.setView(e)):a&&b&&(o=ut()?new gt(a.y+p,a.x+y):i.getCenter(),ot(o,s.clickLocation),e={center:o,zoom:ft()?b:i.getZoom(),animate:!0},i.setView(e))}}function ot(n,t){while(n.longitude-t.longitude>180&&n.longitude>t.longitude)n.longitude-=360;while(t.longitude-n.longitude>180&&n.longitude<t.longitude)n.longitude+=360}function st(n){var s=i.getMode().tryPixelToMercatorPoint,t,c,r,u,e,o;if(s){t=s(n),c=new f(t.x,t.y),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1;for(var v=kt(t),l=h.getTileHotRegionsForQuadkey(v),a=l.length;a--;)if((r=l[a],!nt||r.type!=="label")&&r.getMercatorBounds().contains(t))for(u=r.boundRegions,e=u.length;e--;)if(o=u[e],o.getMercatorBounds().contains(t)&&o.isMercatorPointInBoundRegion(t))return{hotRegion:r,worldPoint:c}}return null}function ht(){var t={hotRegion:o,cancelDefault:!1};n.invoke(u,"leave",t),!t.cancelDefault&&l&&(it.set_style({cursor:l}),l=null),o=null}function ct(i){var h;if(i.targetType!=="map"&&i.target.pointerEvents!=="none")if(o)var s=!0,c=!1,e=null;else return;if(!s)var v=new f(i.getX(),i.getY()),a=st(v),e=a&&a.hotRegion,s=o&&(!e||e.id!==o.id),c=e&&(!o||o.id!==e.id);s&&ht(),o=e,c&&(h={hotRegion:e,cancelDefault:!1},n.invoke(u,"enter",h),!h.cancelDefault&&e&&e.bmv&&(!r||e.type!=="label")&&(l=it.get_style("cursor"),rt.isWebkit&&l.toLowerCase().indexOf("/cursors/grab.cur")!==-1?l=bt.Grab:t.Browser.is_ie&&(l+=", "+bt.Grab),(ut()||ft())&&it.set_style({cursor:"pointer"})))}function at(){s||(s=n.addHandler(i,"mousemove",ct)),w||(w=n.addHandler(i,"click",hi)),g||(_mapMouseClickDoubleHandle=n.addHandler(i,"dblclick",si)),b||(b=n.addHandler(i,"viewchangeend",et)),k||(k=n.addHandler(i,"viewchangestart",oi))}function vt(){c&&(n.removeHandler(c),c=null),s&&(n.removeHandler(s),s=null),w&&(n.removeHandler(w),w=null),g&&(n.removeHandler(g),g=null),b&&(n.removeHandler(b),b=null),k&&(n.removeHandler(k),k=null),o&&ht()}function ri(){h.getLayerCount()>0?at():vt()}var u=this,s,w,g,yt,wt,b,k,nt=r,h=new dr,bt={Grab:"url("+y.cursorPath+"grab.cur)"+rt.cursorHotspot+", default"},it=t(i.getRootElement()),l=null,o=null,ui=new lt(e.Globals.hotRegionsRoadUrl,null,i,"r"),fi=new lt(e.Globals.hotRegionsAerialWithLabelsUrl,null,i,"a"),a=null,d,c,v;u.getHotRegionAtPoint=function(n){var t=st(n);return t&&t.hotRegion},u.enable=function(){at(),yt=n.addHandler(i,"maptypechanged",ti),wt=n.addHandler(i,"imagerychanged",ii),ti(),ii()},u.disable=function(){vt(),n.removeHandler(wt),n.removeHandler(yt),o=null},u.createLayer=function(n,t,i,r){return new lt(n,t,i,r)},u.addLayer=function(n,t){h.addLayer(n,t),ri(),et()},u.removeLayer=function(n){h.removeLayer(n),ri()},i.addComponent("hotRegions",u),u.enable()}function wt(n,t){function c(n){for(var i=[],r=n.length,t;r--;)t=n[r],i.push(new f(t.x,t.y));return i}var i,o,u,r,s,p,h;n.boundRegions=[];for(var l=n.boundRegions,a=n.brs,e=a.length;e--;)i=a[e],pi(i)?(r=c(i),r.push(r[0]),o=new ii(t,r),l.push(o)):i&&i.x&&i.y&&i.r&&(o=new ri(t,new f(i.x,i.y),i.r),l.push(o));if(n.hbrs){n.highlightBoundRegions=[];for(var v=n.highlightBoundRegions,y=n.hbrs,e=y.length;e--;)if(u=y[e],u)switch(u.t){case"polygon":r=c(u.v),r.push(r[0]),s=new ii(t,r),v.push(s);break;case"circle":s=new ri(t,new f(u.x,u.y),u.r),v.push(s)}}return p=/^YN/i,h=n.ypid,h&&p.test(h)&&(n.ypid=h.substring(2)),n.getLocationCenter=wt.prototype.getLocationCenter,n.getMercatorBounds=wt.prototype.getMercatorBounds,n}function vi(n){this.hotRegions=n}function ii(n,t){this._tileId=n,this._quadkeyTilePoints=t}function ri(n,t,i){this._tileId=n,this._quadkeyTilePointCenter=t,this._quadkeyTilePointRadius=i}function gr(i){function b(n){var t=!1,r;return n.hotRegion.type==="vm"&&(e.VenueMaps?(h||(h=new e.VenueMaps.VenueMapFactory(i)),r=h.getActiveVenueMap(),r&&n.hotRegion.vmid===r.id||(t=!0)):t=!0),t}function it(n){b(n)&&(n.cancelDefault=!0,s!==n.hotRegion.vmid&&lt(n.hotRegion.vmid))}function ut(n){b(n)&&(n.cancelDefault=!0,o=l.get_style("cursor"),rt.isWebkit&&o.toLowerCase().indexOf("/cursors/grab.cur")!==-1?o=d.Grab:t.Browser.is_ie&&(o+=", "+d.Grab),s===n.hotRegion.vmid?l.set_style({cursor:"wait"}):l.set_style({cursor:"pointer"}),f=n.hotRegion,et())}function ft(n){b(n)&&(o&&(l.set_style({cursor:o}),o=null),k(),f=null)}function k(){nt(),a&&(i.entities.remove(a),a=null)}function et(){var n,t,r,u;if(k(),f){for(a=new ei({zIndex:-1}),n=f.highlightBoundRegions?f.highlightBoundRegions:f.boundRegions,t=n.length;t--;)r=n[t],r.type==="polygon"&&(u=new rr(r.getLocations(),{strokeThickness:1,strokeColor:new si(255,0,0,0),fillColor:new si(0,0,0,0)}),u.pointerEvents="none",a.push(u));i.entities.push(a),s!==f.vmid&&ot()}}function ot(){if(!r){g=n.addHandler(i,"mousemove",st),r=document.createElement("span"),r.style.cssText="position:absolute;visibility:hidden;background-color:white;border: 1px solid black;padding:5px;";var t=f.name?u.getString("L_VenueMapExplorerTooltip_Text").replace("{0}",f.name):u.getString("L_VenueMapExplorerTooltip_Text").replace(" {0}","");r.appendChild(document.createTextNode(t)),i.getRootElement().appendChild(r)}}function nt(){r&&(n.removeHandler(g),r.parentNode.removeChild(r),r=null)}function st(n){r.style.visibility="visible",r.style.left=i.getWidth()/2+16+n.getX()+"px",r.style.top=i.getHeight()/2+16+n.getY()+"px"}function ht(){v||(v=n.addHandler(i.getComponent("hotRegions"),"click",it),p=n.addHandler(i.getComponent("hotRegions"),"enter",ut),w=n.addHandler(i.getComponent("hotRegions"),"leave",ft))}function ct(){v&&(n.removeHandler(v),v=null),p&&(n.removeHandler(p),p=null),w&&(n.removeHandler(w),w=null)}function lt(n){vt(n),e.loadModule("Microsoft.Maps.VenueMaps",{callback:function(){h||(h=new e.VenueMaps.VenueMapFactory(i));var t=h.getActiveVenueMap();t&&t.dispose(),h.create({venueMapId:n,success:at,error:yt})}})}function at(n){if(s===n.id){var t=n.bestMapView;t.animate=!0,i.setView(t),n.show(),tt(!0)}}function vt(t){s=t,f&&(l.set_style({cursor:"wait"}),nt()),n.invoke(c,"activationstart",t)}function tt(t){var i=s;s=null,f&&(o&&(l.set_style({cursor:o}),o=null),k()),n.invoke(c,"activationend",{isSuccess:t,venueMapId:i})}function yt(n,t){s===t.venueMapId&&tt(!1)}var c=this,v,p,w,h,s,o,d={Grab:"url("+y.cursorPath+"grab.cur)"+rt.cursorHotspot+", default"},l=t(i.getRootElement()),f,a,r,g;c.enable=function(){ht()},c.disable=function(){ct(),s=null},i.addComponent("venueMapsExplorer",c),c.enable()}function ft(){return null}function iu(n,t){function o(r,f){var s,e,o,h;r||f&&f.httpStatus===401?(s=r&&r.authenticationResultCode=="ValidCredentials",i=s&&typeof r.sessionId=="string"&&r.sessionId.length>0?r.sessionId:null,s||(e=document.createElement("div"),e.style.cssText="position:absolute; width:100%; top:50%; text-Align:center",o=document.createElement("div"),o.innerHTML=u.getString("L_invalidcredentials_text"),o.style.cssText="background: #f8f7f5; padding:10px; color: #000;",e.appendChild(o),h=n&&n.getRootElement(),h&&h.appendChild(e))):i=t,y.sessionId=i,_cleanup()}var e=this,r=y.logServiceUriFormat,f,i;if(r){f=[],r=r.replace(/{credentials}/,t),y.credentials=t,this.getCredentials=function(n){f.push(n)};function _cleanup(){e.getCredentials=function(n){n(i)};for(var n=f.length;n--;)e.getCredentials(f[n])}yt.getObjectAsyncWithNoJsonso(r,o,kt.getNext(),1e4)}else i=t,this.getCredentials=function(n){n(i)}}function c(n){function i(i){if(!i||i.handled!==!0){t&&t.dispose();var r=c.getRenderer(n.overlays);typeof r=="function"&&(t=new r(n,n.getRootElement(),n.overlays))}}var t;this.update=i}function wi(n){this.setOptions(n)}function bi(n){this.setOptions(n)}function ki(n){this.setOptions(n)}function et(n){this._namedEntities={},et.baseConstructor.call(this,n),this.setOptions(n)}function di(n){this.setOptions(n)}function gi(n){this.setOptions(n)}function nr(n){this.setOptions(n)}function tr(n){this.setOptions(n)}var e=window[$MapsNamespace].Maps,a=e.InternalNamespaceForDelay,ui=a.KeyEventArgs,u=window[$MapsNamespace].Maps.Resources,w=a.Common,ir=a.DelayMap,kt=a.IdGenerator,yt=a.Network,fi=a.PRF,ut,b,g,ct,nt,st,l;fi.start("mapdelay"),u.init(
{"L_invalidcredentials_text":"The specified credentials are invalid. You can sign up for a free developer account at \u003ca href=\"http://www.bingmapsportal.com\"\u003ehttp://www.bingmapsportal.com\u003c/a\u003e","L_scaleBarKilometers_Text":"{num} km","L_scaleBarMeters_Text":"{num} m","L_scaleBarMiles_Text":"{num} miles","L_scaleBarYards_Text":"{num} yds","L_scaleBarFeet_Text":"{num} feet","L_compassTooltip_Text":"Click to pan in any direction","L_rotateLeftTooltip_Text":"Rotate left","L_rotateRightTooltip_Text":"Rotate right","L_zoomInTooltip_Text":"Zoom in","L_zoomOutTooltip_Text":"Zoom out","L_zoomSliderTooltip_Text":"Move slider to zoom in or out","L_compassNorthLabel_Text":"N","L_mapTypeAutoName_Text":"Automatic","L_mapTypeAutoDescription_Text":"Switches to the best map style as you zoom","L_mapTypeRoadName_Text":"Road","L_mapTypeRoadDescription_Text":"A standard road map","L_mapTypeAerialName_Text":"Aerial","L_mapTypeAerialDescription_Text":"A detailed look from above","L_mapTypeBirdsEyeName_Text":"Bird\u0027s eye","L_mapTypeBirdsEyeDescription_Text":"A better angle of aerial photography","L_mapTypeCollinsBartName_Text":"London Street Map","L_mapTypeCollinsBartDescription_Text":"Detailed maps for Greater London","L_mapTypeOrdnanceSurveyName_Text":"Ordnance Survey Map","L_mapTypeOrdnanceSurveyDescription_Text":"Maps for outdoor life","L_aerialShowLabels_Text":"show labels","L_aerialEnableTilt_Text":"show angled view","L_BingSearchWatermark_Text":"Search on Bing","L_BingSearchGoTooltip_Text":"Search on Bing","L_BingLogoTooltip_Text":"Bing Maps","L_world_Text":"World","L_currentIconTooltip_Text":"Return to last location","L_VenueMapExplorerTooltip_Text":"View {0} Map","L_breadcrumbNear_Text":"Near {0}"}
);var t=e.Gimme,y=e.Globals,ru=e.Map,f=e.Point,tt=e.LabelOverlay,n=e.Events,dt=e.LocationRect,gt=e.Location,uu=e.Pushpin,k=e.MapTypeId,ei=e.EntityCollection,it=a.MercatorCube,oi=a.SpatialCache,ni=e.QuadKey,pt=a.TileId,fu=e.AltitudeReference,ti=a.Rect,si=e.Color,rr=e.Polygon,ht=a.MapMath,rt=a.Quirks,ur=a.IOSec,v=new function(){function o(n,t,i){var r=document.createElement(n||"div");return t&&(r.className=t),i&&i.appendChild(r),r}function s(n){for(var i,t=u.length;t--;)u[t][0]===n&&(i=u[t][1]);return i}function h(t,i,r){n.invoke(t,i,r)}function f(n){n.stopPropagation()}function r(n){e=!0,n.stopPropagation()}var u=[],e=!1;this.addIgnoreEvents=function(n){t(n).add_event("mousedown",i).add_event("mouseup",i).add_event("mousewheel",i).add_event("dblclick",i).add_event("contextmenu",i).add_event("keydown",f).add_event("keyup",i).add_event("click",i).add_event("touchstart",r).add_event("touchmove",r).add_event("touchend",r).add_event("touchcancel",r)},this.removeIgnoreEvents=function(n){t(n).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousewheel",i).remove_event("dblclick",i).remove_event("contextmenu",i).remove_event("keydown",f).remove_event("keyup",i).remove_event("click",i).remove_event("touchstart",r).remove_event("touchmove",r).remove_event("touchend",r).remove_event("touchcancel",r)},this.createElement=o,this.createToolButton=function(n,t){var i=o("a","NavBar_button NavBar_toolButton "+(n||""));return i.href="#",t&&(i.title=t),i},this.registerNavigationBar=function(n,t){u.push([n,t])},this.removeNavigationBar=function(n){for(var t=u.length;t--;)if(u[t][0]===n){u.splice(t,1);break}},this.reportAction=function(n,t){var r=s(n),i;r&&(i=t.currentTarget,i&&h(r,"navbaraction",{id:i.id,typeName:i.className,title:i.title}))},this.getNavBar=s,this.invokeEvent=h,this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=f,this.isTouch=function(){return e},this.addClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n+(n.search(i)===-1?" "+t:"")},this.removeClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n.replace(i,"$1").replace(/^\s+|\s+$/g,"")}};a.NavigationCommon=v,ut={auto:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeAutoName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeAutoDescription_Text")}})},r:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeRoadName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeRoadDescription_Text")}})},a:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeAerialName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeAerialDescription_Text")}})},be:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeBirdsEyeName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeBirdsEyeDescription_Text")}})},cb:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeCollinsBartName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeCollinsBartDescription_Text")}})},os:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeOrdnanceSurveyName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeOrdnanceSurveyDescription_Text")}})}},b={left:0,middle:1,right:2,getName:function(n){switch(n){case b.left:return"left";case b.middle:return"middle";case b.right:return"right"}return""},isValid:function(n){return n===b.left||n===b.middle||n===b.right}},e.ClientRegion=b,d.Layout={TopBottom:"topBottom",BottomTop:"bottomTop",LeftRight:"leftRight",RightLeft:"rightLeft"},g={light:0,dark:1},g.getImageryBackground=function(n){return n==="Aerial"||n==="EnhancedBirdseye"||n==="NativeBirdseye"||n==="streetside"?g.dark:g.light},ct={milesFeet:0,milesYards:1,kilometersMeters:2},nt={metersPerKm:1e3,yardsPerMeter:1.0936133,yardsPerMile:1760,feetPerYard:3,feetPerMeter:3.2808399,feetPerMile:5280},wt.prototype={getLocationCenter:function(){for(var i=this.highlightBoundRegions?this.highlightBoundRegions:this.boundRegions,r=0,u=0,n=i.length,e=n,t;e--;)t=i[e].getMercatorBounds().getCenter(),r+=t.x,u+=t.y;return this._locationCenter=it.toLocation(new f(r/n,u/n)),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorBounds:function(){var t=null,i=null,r=null,u=null,e=this.boundRegions,f=this.boundRegions.length-1,n;if(f>-1)for(n=e[f].getMercatorBounds(),t=n.y,i=n.x,r=n.getRight(),u=n.getBottom();f--;){var n=e[f].getMercatorBounds(),o=n.y,s=n.x,h=n.getRight(),c=n.getBottom();o<t&&(t=o),c>u&&(u=c),s<i&&(i=s),h>r&&(r=h)}return this._mercatorBounds=new ti(i,t,r-i,u-t),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds}},vi.prototype={getHotRegionsForTile:function(n){var r={},h,u,t,c,o,s;for(this._tileIndexedHotRegions=r,h=n.length,u=this.hotRegions,t=0,c=u.length;t<c;t++)for(var e=u[t],i=e.getMercatorBounds(),v=new f(i.x,i.y),y=new f(i.getRight(),i.getBottom()),w=p.getMercatorBoundsDescriptor(v,y,h),l=p.getQuadkeysForBounds(w),a=l.length;a--;)o=l[a],s=r[o],s?s.push(e):r[o]=[e];return this.getHotRegionsForTile=function(n){var t=this._tileIndexedHotRegions[n];return t?t:[]},this.getHotRegionsForTile(n)}};var lt=function(n,t,i,r){function y(n,t){return n.z-t.z}function l(n){return n==="l1"?1:n==="l2"?2:n.length+2}function w(n,t){var u=l(n),f=o[u],r=h[u],y,s,a,e,w,v;if(f||(f=o[u]={},r=h[u]=[]),f[n])return!1;for(f[n]=t,r.push(n),y=(Math.ceil(i.getHeight()/1024)+2*c)*(Math.ceil(i.getWidth()/1024)+2*c);r.length>y;){for(s||(s=k(p.getMapTargetMercatorBounds(i),Math.max(u-2,0))),a=!1,e=0,w=r.length;e<w;e++)if(b(s,r[e])===-1){v=r.splice(0,e+1),delete f[v.pop()],r=r.concat(v),a=!0;break}if(!a)break}return!0}function b(n,t){for(var i=n.length;i--;)if(n[i]===t)return i;return-1}function k(n,t){var i=new f(n.left,n.top),r=new f(n.right,n.bottom),u=p.getMercatorBoundsDescriptor(i,r,t);return p.getQuadkeysForBounds(u)}function d(n,t){var i,o,s;if(delete u[t],n&&rt(n.hrs)){i=null,i=t==="l1"?new pt(-1,0,0):t==="l2"?new pt(0,0,0):ni.toTileId(t);for(var r=[],f=n.hrs,e=f.length;e--;)o=new wt(f[e],i),r.push(o);r.sort(y),s=new vi(r),w(t,s)}}function s(i){var y=l(i),h=o[y],f,e,s,c,v;h&&h[i]||(nt(),u[i]||(u[i]={requestTime:(new Date).getTime()},f="",e="",i==="l1"?e="&lod=1":i!=="l2"&&(f=i),s="0",f!==""&&(s=f.charAt(f.length-1)),c=typeof t=="function"?t(i):n,v=c.replace("{subdomain}",s).replace("{quadkey}",f).replace("{jsonp}",a).replace("{jsonso}",encodeURIComponent(r+"|"+i))+e,yt.getObjectAsyncCacheFriendly(v)))}function g(){u={}}function nt(){var i=(new Date).getTime(),n,t;for(n in u)t=u[n].requestTime,t&&i-t>v&&delete u[n]}function tt(n){var i=p.tileQuadkeyToSheetQuadkey(n),u=n.length,r=o[u],t;if(r){if(t=r[i],t)return t.getHotRegionsForTile(n);s(i)}return[]}function it(n,t){var i;if(t===1)s("l1");else if(t===2)s("l2");else for(var h=Math.max(t-2,0),c=new f(n.left,n.top),l=new f(n.right,n.bottom),a=p.getMercatorBoundsDescriptor(c,l,h),r=p.getQuadkeysForBounds(a),u=o[t],e=r.length;e--;)i=r[e],u&&u[i]||s(i)}function rt(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"}var e=this,a="microsoftMapsHotRegionsCacheCallback",o={},h={},c=1,v=1e4,u={};e.getTileHotRegionsForQuadkey=tt,e.loadQuadkeysForMercatorBounds=it,e.getHotRegionsNetworkCallback=d,e.clearRequestedQuadkeys=g,e.getId=function(){return r}},dr=function(){function i(t){for(var i=n.length;i--;)if(n[i].layer.getId()===t)return i;return null}function r(t,r){if(r){var u=decodeURIComponent(r).split("|"),e=u[0],o=u[1],f=i(e);f!==null&&n[f].layer.getHotRegionsNetworkCallback(t,o)}}function u(t){for(var i=[],r=n.length;r--;)i=i.concat(n[r].layer.getTileHotRegionsForQuadkey(t));return i}function f(t,i){for(var r=n.length;r--;)n[r].layer.loadQuadkeysForMercatorBounds(t,i)}function e(n,t){return t.zIndex-n.zIndex}function o(t,r){t instanceof lt&&(r||(r=0),i(t.getId())===null&&(n.push({zIndex:r,layer:t}),n.sort(e)))}function s(t){if(t instanceof lt){var r=i(t.getId());r!==null&&(n.splice(r,1),t.clearRequestedQuadkeys())}}function h(){return n.length}var t=this,n=[];t.addLayer=o,t.removeLayer=s,t.getLayerCount=h,t.getTileHotRegionsForQuadkey=u,t.loadQuadkeysForMercatorBounds=f,window["microsoftMapsHotRegionsCacheCallback"]=r},p=new function(){this.tilePixelToLocation=function(n,t){var i=this._tilePixelToMapPixel(n,t),r=this._mapPixelToMercatorPoint(n.levelOfDetail,i);return it.toLocation(r)},this.tilePixelToMapPixel=function(n,t){return new f(n.x*1024+t.x,n.y*1024+t.y)},this.mapPixelToMercatorPoint=function(n,t){var i;return i=n<0?1/(1<<Math.abs(n)):1<<n,new f(t.x/i/1024,t.y/i/1024)},this.getMapTargetMercatorBounds=function(n){var r=n.getMode().tryPixelToMercatorPoint,o,t;if(r){var u=n.getHeight()/2,e=n.getWidth()/2,s=new f(-e,-u),i=r(s);return i.x=(i.x%1+1)%1,i.y=(i.y%1+1)%1,o=new f(e,u),t=r(o),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1,{left:i.x,right:t.x,top:i.y,bottom:t.y}}return null},this.getQuadkeysForBounds=function(n){for(var h=n.levelOfDetails,r=n.tileIdXCount,c=n.tileIdYCount,l=n.tileIdX0,a=n.tileIdY0,u=n.tileIdCount,f=[],t,e,o,i,s;r--;)for(t=c,e=(l+r)%u;t--;)o=(a+t)%u,i=ni.fromTileId(new pt(h,e,o)),i.length===0&&(s=0,s++),f.push(i);return f},this.getMercatorBoundsDescriptor=function(n,t,i){var u=oi.mercatorXYToTileId(n,i),o=oi.mercatorXYToTileId(t,i),r=1<<i,e=(o.x-u.x+r)%r+1,h=u.x,s,f;return e===1&&t.x<n.x&&(e=r,h=0),f=(o.y-u.y+r)%r+1,s=u.y,f===1&&t.y<n.y&&(f=r,s=0),{mercatorTL:n,mercatorBR:t,levelOfDetails:i,tileIdTL:u,tileIdBR:o,tileIdX0:h,tileIdY0:s,tileIdXCount:e,tileIdYCount:f,tileIdCount:r}},this.tileQuadkeyToSheetQuadkey=function(n){var t=n.length,i="l1";return t>2?i=n.substr(0,t-2):t===2&&(i="l2"),i}};ii.prototype={type:"polygon",getLocations:function(){var r,u;this._locations=[];for(var n=this._locations,t=this.getMercatorPoints(),i=t.length;i--;)r=t[i],u=it.toLocation(r),n.push(u);return this.getLocations=function(){return this._locations},n},getMercatorPoints:function(){var r,u;this._mercatorPoints=[];for(var n=this._mercatorPoints,t=this.getMapPixels(),i=t.length;i--;)r=t[i],u=p.mapPixelToMercatorPoint(this._tileId.levelOfDetail,r),n.push(u);return this.getMercatorPoints=function(){return this._mercatorPoints},n},getMapPixels:function(){var r;this._mapPixels=[];for(var n=this._mapPixels,t=this._quadkeyTilePoints,i=t.length;i--;)r=p.tilePixelToMapPixel(this._tileId,t[i]),n.push(r);return this.getMapPixels=function(){return this._mapPixels},n},getMercatorBounds:function(){var e=null,o=null,t=null,i=null,r=this.getMercatorPoints(),n=r.length-1,u,f;if(n>-1)for(e=t=r[n].x,o=i=r[n].y;n--;)u=r[n].x,f=r[n].y,u>e?e=u:u<t&&(t=u),f>o?o=f:f<i&&(i=f);return this._mercatorBounds=new ti(t,i,e-t,o-i),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){for(var t=this.getMercatorPoints(),o=t.length-1,c=n.x,u=n.y,f=!1,i=0,r=o-1;i<o;r=i++){var e=t[i].y,s=t[r].y,h=t[i].x,l=t[r].x;e>u!=s>u&&c<(l-h)*(u-e)/(s-e)+h&&(f=!f)}return f}},ri.prototype={getLocations:function(){var n=this.getMercatorBounds(),i=new f(n.x,n.y),r=new f(n.getRight(),n.y),u=new f(n.getRight(),n.getBottom()),e=new f(n.x,n.getBottom()),t=it.toLocation(i),o=it.toLocation(r),s=it.toLocation(u),h=it.toLocation(e);return this._locationBounds=[t,o,s,h,t],this.getLocations=function(){return this._locationBounds},this._locationBounds},type:"circle",getLocationCenter:function(){return this._locationCenter=it.toLocation(this.getMercatorCenter()),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorCenter:function(){return this._mercatorCenter=p.mapPixelToMercatorPoint(this._tileId.levelOfDetail,this.getMapCenter()),this.getMercatorPoints=function(){return this._mercatorCenter},this._mercatorCenter},getMercatorRadius:function(){return this._mercatorRadius=p.mapPixelToMercatorPoint(this._tileId.levelOfDetail,new f(0,this._quadkeyTilePointRadius)).y,this.getMercatorRadius=function(){return this._mercatorRadius},this._mercatorRadius},getPixelRadius:function(){return this._quadkeyTilePointRadius},getMapCenter:function(){return this._mapCenter=p.tilePixelToMapPixel(this._tileId,this._quadkeyTilePointCenter),this.getMapCenter=function(){return this._mapCenter},this._mapCenter},getMercatorBounds:function(){var t=this.getMercatorCenter(),n=this.getMercatorRadius(),i=2*n;return this._mercatorBounds=new ti(t.x-n,t.y-n,i,i),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){var t=this.getMercatorCenter(),i=this.getMercatorRadius(),r=n.x-t.x,u=n.y-t.y;return r*r+u*u-i*i<=0}};var i=v.ignoreEvent,s=v.stopPropagation,h=v.reportAction,o=v.invokeEvent,r=v.createElement,at=v.createToolButton,ot=v.addIgnoreEvents,yi=v.removeIgnoreEvents,vt=v.isTouch,bt=v.addClass,nu=v.removeClass,tu=w.extend,pi=w.isArray;st=ir.prototype,st.showOverlays=function(t){var i,w,r,nt,h,b,l,a,tt,k,u,v,d,o,s,f,it,rt,g,ut,y,ot,p;if(this._map){if(i=this._map,w=!1,e.Themes&&(w=i.getTheme()instanceof e.Themes.BingTheme),r=new et({className:"MicrosoftNav"}),r.setNextSibling(i.getRootElement().firstChild),nt={breadcrumb:{overlayClass:bt(r.getClassName(),"NavBar_breadcrumb"),constructor:tr,args:t,displayField:"showBreadcrumb",defaultDisplay:!1},compass:{constructor:ki},zoom:{constructor:bi},modeselector:{constructor:wi,args:t,displayField:"showMapTypeSelector",defaultDisplay:!0,postCreate:function(n,t){b=new hr(i,t,n)}}},h=w?["modeselector","breadcrumb","zoom","compass"]:["breadcrumb","compass","zoom","modeselector"],t.showDashboard!==!1){for(l=new et({className:"OverlaysTL",stopPropagation:!0}),t.showDualMapTypeSelector&&(r.setOptions({className:bt(r.getClassName(),"NavBar_typeButton_count2")}),t.mapTypes=[]),tt=h.length,a=0;a<tt;a++)if(k=h[a],u=nt[k],u){if(u.displayField&&(v=t[u.displayField],v!==undefined&&!v||v===undefined&&!u.defaultDisplay))continue;u.overlayClass&&r.setOptions({className:bt(r.getClassName(),u.overlayClass)}),d=new u.constructor(u.args),l.addNamedEntity(k,d),u.postCreate&&u.postCreate(d,l)}r.addNamedEntity("overlaysTL",l)}(t.showScalebar!==!1||t.showCopyright!==!1||t.showLogo!==!1)&&(s=new et({className:"OverlaysBL"}),s.setParentOverride(i.getRootElement()),f=new et({className:"OverlaysBR"}),f.setParentOverride(i.getRootElement()),t.showLogo!==!1&&(it=new gi(t),o=t.logoPosition==="bottomLeft"?s:f,o.addNamedEntity("logo",it)),t.showScalebar!==!1&&(rt=new nr,o=t.scalebarPosition==="bottomLeft"?s:f,o.addNamedEntity("scalebar",rt)),t.showCopyright!==!1&&(g={},t.copyrightStacked===!0&&(g.className="CopyrightContainer stacked"),ut=new di(g),o=t.copyrightPosition==="bottomLeft"?s:f,o.addNamedEntity("copyright",ut)),t.copyrightPosition==="bottomRight"&&t.showLogo!==!1&&f.setOptions({className:"OverlaysBR-logoAware"}),r.addNamedEntity("overlaysBR",f),r.addNamedEntity("overlaysBL",s));function ft(){var n=r.getClassName();y&&(n=nu(n,"MapTypeId_"+y)),y=i.getMapTypeId(),n=bt(n,"MapTypeId_"+y),r.setOptions({className:n})}ot=n.addHandler(i,"maptypechanged",ft),ft();function st(){p&&(n.removeHandler(p),p=null,n.removeHandler(ot))}p=n.addHandler(i,"ondispose",st),i.overlays=r,n.invoke(i,"overlayscreationstart",{map:i,overlays:r}),this._overlays||(this._overlays=new c(i),this._overlays.update()),b&&i.addComponent("navigationBar",b)}},st.showHotRegions=function(n){this._map&&new kr(this._map,n)},st.showVenueMapsExplorer=function(){this._map&&new gr(this._map)},st.authenticate=function(n){this._map&&(this._authentication=new iu(this._map,n))},st.getCredentials=function(n){this._map&&this._authentication.getCredentials(n)},c.renderers={},c.registerOverlay=function(n,t){c.renderers[n]=t},c.getRenderer=function(n){return c.renderers[n.toString()]},a.Overlays=c,wi.prototype={_className:"NavBar_modeSelectorControlContainer",_mapTypes:null,_disableBirdseye:!1,getDomElement:ft,getClassName:function(){return this._className},getMapTypes:function(){return this._mapTypes},getDisableBirdseye:function(){return this._disableBirdseye},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),pi(t.mapTypes)&&(this._mapTypes=t.mapTypes,i=!0),typeof t.disableBirdseye=="boolean"&&(this._disableBirdseye=t.disableBirdseye,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ModeSelectorControl]"}},c.registerOverlay("[ModeSelectorControl]",ar),bi.prototype={_className:"NavBar_zoomControlContainer",_zoomInVisible:!0,_zoomOutVisible:!0,_zoomBarVisible:!0,_zoomBarToggle:!0,getDomElement:ft,getClassName:function(){return this._className},getZoomInVisible:function(){return this._zoomInVisible},getZoomOutVisible:function(){return this._zoomOutVisible},getZoomBarVisible:function(){return this._zoomBarVisible},getZoomBarToggle:function(){return this._zoomBarToggle},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.zoomInVisible=="boolean"&&(this._zoomInVisible=t.zoomInVisible,i=!0),typeof t.zoomOutVisible=="boolean"&&(this._zoomOutVisible=t.zoomOutVisible,i=!0),typeof t.zoomBarVisible=="boolean"&&(this._zoomBarVisible=t.zoomBarVisible,i=!0),typeof t.zoomBarToggle=="boolean"&&(this._zoomBarToggle=t.zoomBarToggle,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ZoomControl]"}},c.registerOverlay("[ZoomControl]",lr),ki.prototype={_className:"NavBar_compassControlContainer",_compassVisible:!0,_rotateVisible:!0,getDomElement:ft,getClassName:function(){return this._className},getCompassVisible:function(){return this._compassVisible},getRotateVisible:function(){return this._rotateVisible},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.compassVisible=="boolean"&&(this._compassVisible=t.compassVisible,i=!0),typeof t.rotateVisible=="boolean"&&(this._rotateVisible=t.rotateVisible,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CompassControl]"}},c.registerOverlay("[CompassControl]",fr),tu(et,ei),l=et.prototype,l.getDomElement=ft,l._nextSibling=null,l.getNextSibling=function(){return this._nextSibling},l.setNextSibling=function(n){this._nextSibling=n},l._parentOverride=null,l.getParentOverride=function(){return this._parentOverride},l.setParentOverride=function(n){this._parentOverride=n},l._className="",l.getClassName=function(){return this._className},l._stopPropagation=!1,l.getStopPropagation=function(){return this._stopPropagation},l.setOptions=function(t,i){var r=et.superClass.setOptions.call(this,t,!0);return t&&(typeof t.className=="string"&&(this._className=t.className,r=!0),typeof t.stopPropagation=="boolean"&&(this._stopPropagation=t.stopPropagation,r=!0)),r&&!i&&n.invoke(this,"entitychanged",{entity:this}),r},l.addNamedEntity=function(n,t){this._namedEntities[n]=t,this.push(t)},l.insertNamedEntity=function(n,t,i){this._namedEntities[n]=t,this.insert(t,i)},l.getNamedEntity=function(n){return this._namedEntities[n]},l.removeNamedEntity=function(n){var t=this._namedEntities[n];t&&(delete this._namedEntities[n],this.remove(t))},l.toString=function(){return"[OverlayEntityCollection]"},c.registerOverlay("[OverlayEntityCollection]",vr),di.prototype={_className:"CopyrightContainer",getDomElement:ft,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CopyrightControl]"}},c.registerOverlay("[CopyrightControl]",yr),gi.prototype={_className:"LogoContainer",_clickable:!0,_enableSearch:!0,_showCombinedOnly:!1,getDomElement:ft,getClassName:function(){return this._className},getClickable:function(){return this._clickable},getEnableSearch:function(){return this._enableSearch},getShowCombinedOnly:function(){return this._showCombinedOnly},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.clickable=="boolean"&&(this._clickable=t.clickable,i=!0),typeof t.enableSearch=="boolean"&&(this._enableSearch=t.enableSearch,i=!0),t.showLogo==="combined"&&(this._showCombinedOnly=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[LogoControl]"}},c.registerOverlay("[LogoControl]",pr),nr.prototype={_className:"ScaleBarContainer",getDomElement:ft,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ScalebarControl]"}},c.registerOverlay("[ScalebarControl]",br),tr.prototype={_className:"BreadcrumbContainer",getDomElement:ft,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[BreadcrumbControl]"}},c.registerOverlay("[BreadcrumbControl]",cr),delete window[$MapsNamespace].Maps.initMapDelayCode,a.Dynamic&&a.Dynamic.done("Microsoft.Maps.Overlays"),fi.end("Map delay initialized","mapdelay")},window[$MapsNamespace].Maps.Map&&window[$MapsNamespace].Maps.initMapDelayCode&&window[$MapsNamespace].Maps.initMapDelayCode(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initInfoboxRenderer=function(){function v(u){function s(n,i,u){if(n.trueEntity&&s(n.trueEntity,i,u),r.hasHandler(n,i)){var f=t.Screen.get_mouse_pos(u),e=new l(c,"infobox",n,i,f.x,f.y,0,!1,u);r.invoke(n,i,e)}}function y(n,r){var e=r&&r[f],o=e&&e.infoBoxNode,u;if(o&&(u=t(o).select("a[href!=#recycle],link[href],button,input,command,textarea,select").filter(function(n){return!n.disabled}),u=u[n.forwardFocus?0:u.length-1],u&&r.getTypeName()!==i.InfoboxType.mini))try{u.focus(),n.nativeEvent.preventDefault()}catch(s){}}var c=u,v="cm"+a.getNext(),f=v+"_etr";this.shouldDraw=function(n,t){return n.getVisible()&&(n.getClip()===!1?t.actualBounds.contains(n.getLocation()):t.currentBounds.contains(n.getLocation()))},this.update=function(l,a){var ni=a.customRenderer,ft=a.update,ti=l.trueEntity||l,p,v,st,ii,yt,rt,b,ct,fr,ri,li,ut,ui,et,nt,d,it,fi,ht,w,ai,g,k,pt,ei,oi,lr,tt,yi,kt,pi,wi,si,bi,lt,or,sr,hi,gi,bt,nr,tr,ir,rr,ur,cr,ot,vt;if(r.hasHandler(ti,"focusreceived")||r.addHandler(ti,"focusreceived",function(n){y(n,l)}),v=l[f],v?(ft=v.updateEntity||ft,v.updateEntity=!1):(p=n(null,h.safariRenderHack),st=document.createElement("a"),st.href="#recycle",st.innerHTML="&nbsp;",st.style.cssText="position:absolute;height:1px;width:1px;top:0;left:0;text-decoration:none;line-height:0;",ii=st.cloneNode(!0),st.onclick=ii.onclick=function(){return!1},st.onfocus=ii.onfocus=function(){var n=ti.getPushpin();n&&n.receiveFocus()},v={dom:p,recycleAnchors:{a:st,z:ii}},l[f]=v,ft=!0),p=v.dom,yt=l.getTypeName(),rt=l.getHtmlContent()==null||l.getTitle()!==null&&l.getTitle()!==""||l.getDescription()!==null&&l.getDescription()!="",ft)if(v.htmlContent!=null&&rt&&(v.htmlContent.style.display="none",v.infoBoxNode!=null&&(v.infoBoxNode.style.display="")),rt){for(v.infoBoxNode==null?(b=n("div"),p.appendChild(b),b.className=yt,v.infoBoxNode=b):(b=v.infoBoxNode,b.className=yt),b.offsetWidth,l.getShowCloseButton()&&v.closeButtonNode==null&&rt?(ct=n("a"),fr=document.createTextNode("x"),b.appendChild(ct),ct.className="infobox-close",ct.href="#",ct.appendChild(fr),ri=function(n){n.preventDefault(),(l.trueEntity||l).setOptions({visible:!1})},t(ct).add_event("click",ri).add_event("touchend",ri),v.closeButtonHideEvent=ri,v.closeButtonNode=ct):l.getShowCloseButton()&&rt||!v.closeButtonNode||(t(v.closeButtonNode).remove_event("click",v.closeButtonHideEvent).remove_event("touchend",v.closeButtonHideEvent),v.closeButtonHideEvent=null,b.removeChild(v.closeButtonNode),v.closeButtonNode=null),li=l.getHeight()-55,l.getActions().length>0&&(li-=32),ut=l.getTitle(),ui=null,ut===""&&(ut=null),ut&&l.getTitleIsPlaintext()&&(ui=document.createTextNode(ut)),et=l.getDescription(),et===""&&(et=null),nt=v.contentNode,nt==null&&rt?(nt=n("div"),nt.className="infobox-body",b.appendChild(nt),v.contentNode=nt):nt==null||rt||(b.removeChild(nt),v.contentNode=null),d=v.titleDivNode,ut!=null&&v.titleDivNode==null&&(d=n("div"),d.className="infobox-title",nt.insertBefore(d,nt.firstChild),v.titleDivNode=d),it=v.titleLinkNode,it!=null&&(v.titleLinkHandler!=null&&(t(it).remove_event("click",v.titleLinkHandler).remove_event("touchend",v.titleLinkHandler),v.titleLinkHandler=null),it.firstChild&&it.removeChild(it.firstChild),v.titleLinkNode=null,it=null);d!=null&&d.firstChild;)d.removeChild(d.firstChild);if(ut==null&&d!=null&&(nt.removeChild(d),v.titleDivNode=null),ut!=null&&(fi=d,l.getTitleClickHandler()!=null&&(fi=it=n("a"),d.appendChild(it),v.titleLinkNode=it,it.setAttribute("href","#"),t(it).add_event("click",l.getTitleClickHandler()).add_event("touchend",l.getTitleClickHandler()),v.titleLinkHandler=l.getTitleClickHandler()),ui?fi.appendChild(ui):fi.innerHTML=ut),ut!==null&&l.getTitleAction()!==null&&(ht=l.getTitleAction(),v.titleAction=[],w=n("a"),w.className="infobox-titleActionLink",w.appendChild(document.createTextNode(ht.label)),kt=ht.url?ht.url:"#",w.setAttribute("href",kt),ht.urltarget&&w.setAttribute("target",ht.urltarget),ai=document.createElement("span"),ai.className="infobox-titleActionSeparator",d.appendChild(ai),d.appendChild(w),t(w).add_event("click",ht.eventHandler).add_event("touchend",ht.eventHandler)),g=v.descriptionNode,et!=null&&g==null&&(g=n("div"),g.cssText="height:"+li+"px",g.className="infobox-info",v.actionsNode?nt.insertBefore(g,v.actionsNode):nt.appendChild(g),v.descriptionNode=g),et!=null)if(et.innerHTML){while(g.firstChild)g.removeChild(g.firstChild);g.appendChild(et)}else g.innerHTML=et;else g&&(p.removeChild(g),v.descriptionNode=null);if(k=l.getActions(),k.length>0)if(v.actionsNode!=null){while(v.actionsNode.firstChild)v.actionsNode.removeChild(v.actionsNode.firstChild);pt=v.actionsNode}else pt=n("div"),v.actionsNode=pt,pt.className="infobox-actions",nt.appendChild(pt);if(v.actionsEventHandlers!=null)try{while((ei=v.actionsEventHandlers.pop())!=null)t(ei.elem).remove_event("click",ei.event).remove_event("touchend",ei.event)}catch(pr){}if(k.length>0){for(oi=n("ul"),oi.className="infobox-actions-list",lr=[],v.actionsEventHandlers=[],tt=0;tt<k.length;tt++){var er=n("li"),w=n("a"),vi,ar=c.getImageryId();switch(ar){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":vi="dark";break;default:vi="light"}yi=k[tt][vi+"Icon"]||k[tt].icon,kt=k[tt].url?k[tt].url:"#",w.setAttribute("href",kt),k[tt].urltarget&&w.setAttribute("target",k[tt].urltarget),yi?(w.className="icon",pi=n("img"),pi.src=yi,w.appendChild(pi),wi=n("span"),wi.className="iconUnderline",w.appendChild(wi)):(w.innerHTML=k[tt].label,w.id=k[tt].id),er.appendChild(w),oi.appendChild(er),t(w).add_event("click",k[tt].eventHandler).add_event("touchend",k[tt].eventHandler),v.actionsEventHandlers.push({elem:w,event:k[tt].eventHandler})}pt.appendChild(oi)}l.getShowPointer()&&v.pointerNode==null&&rt?(si=n("div"),si.className="infobox-stalk",b.appendChild(si),v.pointerNode=si):l.getShowPointer()&&rt||!v.pointerNode||(b.removeChild(v.pointerNode),v.pointerNode=null)}else bi=l.getHtmlContent(),lt=v.htmlContent,ut==null&&et==null&&bi!=null&&(lt==null&&(lt=n("div"),p.appendChild(lt),v.htmlContent=lt),lt.innerHTML=bi,b=lt,v.infoBoxNode!=null&&(v.infoBoxNode.style.display="none"),v.pointerNode!=null&&(v.pointerNode.style.display="none"),p.style.pointerEvents="all");ti.getPushpin()&&(or=v.recycleAnchors.a,sr=v.recycleAnchors.z,p.insertBefore(or,p.firstChild),p.appendChild(sr));var dt="position:absolute;overflow:visible;white-space:normal;line-height:16px;pointer-events:none;",gt="position:absolute;background-color:white;border:1px solid rgb(136, 136, 136);left:0px;top:0px;pointer-events:auto;",ki="width:33px;height:38px;overflow:hidden;position:absolute;z-index:1;",wt=l.getClip();if(!ni&&(!a.linear||!v.isDrawn||wt===!1))if(hi=c.tryLocationToPixel(l.getLocation(),wt===!1?o.control:o.viewport),hi){var hr=l.getOffset(),di=l.getAnchor(),vr=wt===!1?0:a.parentOffsetLeft||0,yr=wt===!1?0:a.parentOffsetTop||0,ci=hi.x-vr,at=hi.y-yr;ci=ci+hr.x-di.x,at=at-hr.y-di.y,ft&&rt?(dt+="left:"+ci+"px;",dt+="top:"+at+"px;"):(p.style.position="absolute",p.style.left=ci+"px",p.style.top=at+"px",p.style.display="")}else ft?dt+="display:none;":p.style.display="none";ft&&rt&&(gi=l.getZIndex(),typeof gi=="number"&&(dt+="z-index:"+gi+";"),gt+="width:"+l.getWidth(),gt+=typeof l.getWidth()=="number"?"px;":";",gt+="height:"+l.getHeight(),gt+=typeof l.getHeight()=="number"?"px;":";",wt===!1&&(p.className=u.getRootElement().className,t(p).remove_class("MapTypeId_m").add_class("InfoboxExtension")),p.style.cssText=dt+h.safariRenderHack,ki+="left:20px;",ki+="top:"+l.getHeight()+"px;",yt==="Infobox"?v.infoBoxNode.style.cssText=gt:(ot=l.getWidth(),k&&k.length>5&&ot<390&&(ot=ot+16),vt=l.getHeight(),bt="",bt+="width:"+ot,bt+=typeof ot=="number"?"px;":";",bt+="height:"+vt,bt+=typeof vt=="number"?"px;":";",v.infoBoxNode.style.cssText=bt),l.getShowPointer()&&yt==="Infobox"&&(v.pointerNode.style.cssText=ki)),l.getShouldFireEvents()&&(v.mapImageryChanged||(nr=function(){r.invoke(l,"entitychanged",{entity:l})},r.addHandler(c,"imagerychanged",nr),v.mapImageryChanged=nr),v.mouseDoubleClickInfobox||(tr=function(n){s(l,"dblclick",n),n.stopPropagation()},t(p).add_event("dblclick",tr,!0),v.mouseDoubleClickInfobox=tr),v.mouseEnterInfobox||(ir=function(n){s(l,"mouseenter",n),n.stopPropagation()},t(p).add_event("mouseenter",ir,!0),v.mouseEnterInfobox=ir),v.mouseLeaveInfobox||(rr=function(n){s(l,"mouseleave",n),n.stopPropagation()},t(p).add_event("mouseleave",rr,!0),v.mouseLeaveInfobox=rr),v.mouseClickInfobox||(ur=function(n){s(l,"click",n),n.stopPropagation()},t(p).add_event("click",ur,!1),v.mouseClickInfobox=ur),t(p).add_event("touchstart",e)),ni?v.isDrawn?ft&&ni.updateEntity(l):(ni.addEntity(l,p),v.isDrawn=!0):(v.isDrawn||(wt===!1?(cr=u.getRootElement().parentNode,cr.appendChild(p)):a.parentDom.appendChild(p),v.isDrawn=!0),b&&ft===!0&&(yt!==i.InfoboxType.standard||l.getHtmlContent()!==null)&&(ot=b.offsetWidth,vt=b.offsetHeight,l.setCalculatedSize({width:ot,height:vt}),at=at+di.y-vt,p.style.top=at+"px"))},this.remove=function(n,i){if(n&&n[f]){var u=n[f],o=u.dom;o&&u.isDrawn&&(r.removeHandler(u.mapImageryChanged),t(o).remove_event("mouseenter",u.mouseEnterInfobox,!0).remove_event("mouseleave",u.mouseLeaveInfobox,!0).remove_event("click",u.mouseClickInfobox,!1).remove_event("dblclick",u.mouseDoubleClickInfobox,!0).remove_event("touchstart",e,!1),u.mapImageryChanged=u.mouseEnterInfobox=u.mouseLeaveInfobox=u.mouseClickInfobox=u.mouseDoubleClickInfobox=null,o.parentNode&&o.parentNode.removeChild(o)),u.updateEntity=u.updateEntity||i.update,u.isDrawn=!1,i.customRenderer&&i.customRenderer.removeEntity(n)}},this.dispose=function(n){delete n[f]}}var i=window[$MapsNamespace].Maps,t=i.Gimme,y=i.Globals,r=i.Events,c=i.Infobox,o=i.PixelReference,u=i.InternalNamespaceForDelay,s=u.CompositeMode,f=u.Common,l=u.MouseEventArgs,s=u.CompositeMode,a=u.IdGenerator,h=u.Quirks,e=f.stopPropagation,n=f.createElement,e=f.stopPropagation,n=f.createElement;new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof c){for(f=n.length;f--;)n[f]===i&&(u=t[f]);u||(u=new v(i),n.push(i),t.push(u))}return u};s.registerEntityRenderer(i)},delete window[$MapsNamespace].Maps.initInfoboxRenderer},window[$MapsNamespace].Maps.Map&&window[$MapsNamespace].Maps.initInfoboxRenderer&&window[$MapsNamespace].Maps.initInfoboxRenderer()
